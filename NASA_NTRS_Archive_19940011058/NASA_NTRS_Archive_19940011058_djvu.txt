SYSTEMS IIMC 


C931031-U-2R06 


AN EXPERT SYSTEM SHELL FOR INFERRING 
VEGETATION CHARACTERISTICS - 
ATMOSPHERIC TECHNIQUES (TASK G) 


October 1993 


Prepared for: 

National Aeronautics and Space Administration 
Goddard Space Flight Center 
Greenbelt, MD 2077 1 


Prepared by: 


JJM Systems, Inc. 

1225 Jefferson Davis Hwy., Suite 190 
Arlington, VA 22202 


Page P * U2R06 

SYSTEMS INC 

TABLE OF CONTENTS 

Section/Description . Eag£ 

LIST OF FIGURES ii 

LIST OF TABLES iii 

LIST OF ACRONYMS iv 

1.0 INTRODUCTION 1 

2.0 THE SUBGOAL CATEGORY ATMOSPHERIC TECHNIQUES 

IN THE VEG RESEARCH MODE 2 

2.1 ENTER PLATFORM DATA 6 

2.2 CHARACTERIZE INPUT 9 

2.3 CHARACTERIZE TARGET 9 

2.4 ENTER ATMOSPHERIC CONDITIONS 9 

2.5 GENERATE TECHNIQUES 10 

2.6 RANK TECHNIQUES 11 

2.7 EXECUTE TECHNIQUES 11 

2.8 OUTPUT RESULTS 11 

3.0 THE SUBGOAL CATEGORY ATMOSPHERIC TECHNIQUES 

IN THE VEG AUTOMATIC MODE 1 3 

4.0 TESTING AND RESULTS 16 

4.1 TEST 1 16 

4.2 TEST 2 16 

4.3 TEST 3 17 

4.4 TEST 4 18 

4.5 TEST 5 18 

4.6 TEST 6 18 

4.7 TEST 7 19 

5.0 CONCLUSIONS 20 

REFERENCES 21 


APPENDIX A 



SYSTEMS INC 


LIST OF FIGURES 


C931031-U-2R06 
Page ii 




Figure 

Description 

Page 


2-1 

Categories of Subgoals in VEG 

2 


2-2 

The Atmospheric Techniques Menu 

3 

■ ■? 

2-3 

Menu for the Subgoal ATMOSPHERIC.PASSES 

4 


2-4 

Menu for the Subgoal ATMOSPHERIC.CORRECTIONS 

5 

— 

2-5 

The Screen for Entering Original Platform Data 

6 


2-6 

Selecting Historical Data 

7 


2-7 

A Complete Set of Selected Historical Data 

8 


2-8 

The Enter Atmospheric Conditions Screen 

9 


2-9 

The Output Screen for the Subgoal ATMOSPHERIC.PASSES 

12 

H 

3-1 

The VEG Automatic Mode Categories Menu 

13 


3-2 

Running the Subgoal ATMOSPHERIC.CORRECTIONS 




in the VEG Automatic Mode 

14 


SYSTEMS INC 


LIST OF TABLES 


C931031 
Page iii 


Table Description 

3- 1 Input File Format for Atmospheric Techniques and an Example of 

Typical Values 


U-2R06 

Page 

15 


SYSTEMS INC 


LIST OF ACRONYMS 


C931031-U-2R06 
Page iv 


KEE 


VEG 


Knowledge Engineering Environment 
VEGetation Workbench 



SYSTEMS INC 

SECTION 1.0 
INTRODUCTION 


C931031-U-2R06 
Page 1 


The NASA VEGetation Workbench (VEG) infers vegetation characteristics from 
reflectance data. For a detailed description of VEG, see references 1 and 2. A number of subgoals 
are available in VEG. In the previous version of VEG, the subgoals 
SPECTRAL.HEMISPHERICAL.REFLECTANCE, TOTAL. AND.SPECTRAL.HEMISPHERI- 
CAL.REFLECTANCE, PROPORTION.GROUND.COVER, VIEW.ANGLE.EXTENSION and 
LEARN.CLASS.DESCRJPTTONS were implemented. 

The structure of the subgoals in VEG has been modified. Subgoals are now divided into 
categories. Two new subgoals in the category ATMOSPHERIC.TECHNIQUES have been added 
to VEG. The basic framework and interfaces for these subgoals have been implemented. No 
techniques for these subgoals were yet available so dummy techniques for each subgoal were 
included in VEG. Replacement of the dummy techniques with the real techniques when they 
become available should require little additional work. 

This report describes the reorganization of VEG subgoals into categories and the new 
subgoals ATMOSPHERIC. PASSES and ATMOSPHERIC.CORRECTIONS. The code for the 
Lisp methods involved is included in Appendix A. A Sun cartridge tape containing these Lisp 
methods and the current version of VEG including the subgoal category 
ATMOSPHERIC.TECHNIQUES has been delivered to the NASA GSFC technical representative. 


SYSTEMS INC 


C931031-U-2R06 
Page 2 


SECTION 2.0 

THE SUBGOAL CATEGORY ATMOSPHERIC TECHNIQUES IN THE VEG 

RESEARCH MODE 


The structure of the VEG subgoals has been reorganized into four categories as shown in 
Figure 2-1. When the user runs VEG and selects Research Mode, the Categories menu is 
displayed. This menu allows the user to select the required subgoal category. Selecting the 
category VEGETATION.PARAMETER.TECHNIQUES allows the user to select the VEG 
subgoals TOTAL.AND.SPECTRAL.HEMISPHERICAL.REFLECTANCE, SPECTRAL. 
HEMISPHERIC AL. REFLECT ANCE, PROPORTION.GROUND.COVER and VIEW.ANGLE. 
EXTENSION. Selecting the category LEARNING.SYSTEM invokes the learning system. The 
option NEURAL.NETWORK is included in the categories submenu although this category has not 
yet been implemented. 



C931031G1 


Figure 2-1 

Categories of Subgoals in VEG 




I 1 


JdiUl 

SYSTEMS INC 


C931031-U-2R06 
Page 3 


A new category, ATMOSPHERIC.TECHNIQUES, has been added to VEG. When this 
category is selected, the menu shown in Figure 2-2 is displayed. The subgoal 
ATMOSPHER1C.PASSES allows the scientist to take reflectance data measured at ground level 
and predict what the reflectance values would be if the data were measured at a different 
atmospheric height. The subgoal ATMOSPHERIC.CORRECTIONS allows atmospheric 
corrections to be made to data collected from an aircraft or by a satellite to determine what the 
equivalent reflectance values would be if the data were measured at ground level. 


id 



Figure 2-2 

The Atmospheric Techniques Menu 








mm 


C931031-U-2R06 
Page 4 


! f SYSTEMS IIMC 

When the user selects the subgoal ATMOSPHERIC.PASSES from the menu shown in 
Figure 2-2, the menu shown in Figure 2-3 is displayed. Selecting the subgoal 
S ATMOSPHERIC.CORRECTIONS reveals the menu shown in Figure 2-4. The steps involved in 

" the subgoals ATMOSPHERIC.PASSES and ATMOSPHERIC.CORRECTIONS are similar. The 

subgoal ATMOSPHERIC.PASSES will be described in detail in this section. Any variations for 
the subgoal ATMOSPHERIC.CORRECTIONS will be mentioned in the description. 

The menu shown in Figure 2-3 enables the user to invoke the steps involved in processing 
reflectance data to estimate the reflectance values at different atmospheric heights. Before each step 
_ is carried out, a check is made to make sure that the necessary prerequisite steps have been carried 

out. For example, the results cannot be output before the techniques have been executed. If any 
prerequisite steps have not been carried out, a message is displayed and the user is prompted to 
Ej complete the necessary prerequisite steps. 



Figure 2-3 

Menu for the Subgoal ATMOSPHERIC.PASSES 







SYSTEMS INC 


C931031-U-2R06 
Page 5 



Figure 2-4 

Menu for the Subgoal ATMOSPHERIC.CORRECTIONS 








«’?!! 


SYSTEMS INC 


C931031-U-2R06 
Page 6 


2 . 1 ENTER PLATFORM DATA 

The code and interface that were originally developed for the step ENTER.DATA for the 
VEG subgoal SPECTRAL.HEMISPHERIC AL.REFLECT ANCE have been modified for re-use in 
this step. When the user selects the step ENTER.DATA, an interface opens. This interface allows 
the user to either enter a new original set of data for an unknown cover type or select one of a 
number of samples of cover type data stored in the VEG historical database. If the user chooses to 
enter original data, another interface opens as shown in Figure 2-5. This interface allows the user 
to enter data for the new sample. In addition to the data required for the subgoal 
SPECTRAL.HEMISPHERIC AL.REFLECT ANCE, the subgoal ATMOSPHERIC.PASSES 
requires the entry of the atmospheric height to which the reflectance data will be projected. A 
subwindow labeled "Atm Ht (m or (A)bove))" has been added to the screen. This subwindow 
enables the user to enter the number of meters to which the data should be projected or "A" if the 
data are to be projected to above the atmosphere. Each data value is checked as soon as it has been 
entered to make sure that it is of the correct type and is in the valid range for the data item it 
represents. The user can left click on the menu button "SAVE.DATA" at the bottom of the screen 
in Figure 2-5 to store the data. Before a set of cover type data is stored, the system checks that at a 
minimum the solar zenith angle, wavelength, reflectance data and atmospheric height have been 
entered. If any of these items is missing, the user is prompted to supply the missing items before 
the data are stored. 


ESTIMATE ATMOSPHERIC EFFECT - ATMOSPHERIC PASSES 


Wavtltr.gths Avail able 
Unknown 


Unknown 



Enter On 




Fill in the template with any available data about theunknown target. 


Data at the sample level;- 


Unknown 


Pri |« molt Ground Cover Pre&oitjon Grttn 



Cwtter Wavtlencrh fjracrojnettrs) 


Data at the wavelength level:- 


Unknown 


BEBHHB 


list of trip!*'c stub »s VO C 0 5>ftS 67 0 56) > 


Unknown 



SaVTJaaTA SCm.VJASSlNC.nATA 


SYSTTM DESCRIFTION 
HELP IYSTIM 

iRowsr enuri systim 
pLorrmc routwis 

| FXPLORT SCTRSrTS Dr H1ST0RICAI DAT; 

print cuKRrrrr scirrx 


Figure 2-5 

The Screen for Entering Original Platform Data 























SYSTEMS INC 


C931031-U-2R06 
Page 7 


If the user elects to process a sample of cover type data from the historical cover type 
database, the screen shown in Figure 2-6 is opened. It is important that the user enter data into this 
screen in the correct order. When this screen is first opened, only the message and atmospheric 
height subwindows are opened. The other subwindows in this screen are automatically opened in 
turn, after the user has entered the necessary prerequisite data. If the user enters a data value and 
then subsequently changes it, the appropriate subwindows are closed to backtrack the data entry 
process to where the changed data value was first entered. The user is required to first enter the 
atmospheric height. Next the user must select the required cover type from the historical cover 
type database, followed by the sun angle. Figure 2-6 shows the "Select Historical Data" screen at 
this stage of data entry. Once the sun angle has been selected, the user is prompted to select the 
waveband of interest. The user is then prompted to enter the directional data. If invalid directional 
data is entered, the user is prompted to reenter the data in the correct format. Once valid directional 
data have been entered, VEG automatically interpolates and extrapolates the reflectance data for the 
selected historical database cover type to the specified view angles. The complete directional 
reflectance data, including the interpolated and extrapolated reflectance values, are displayed in the 
subwindow labeled "Directional Reflectance Data," as shown in Figure 2-7. 


ESTIMATE ATMOSPHERIC EFFECT - AT MOSPHERIC PASSES 


Wavelengths Available 
Unknown 


Unknown 



COVEJi.TyFfc.lB5 


COVES TYPfc.lW 


coves .rypfc.183 


coves type im 


C0VES.TTPfc.181 


COVES TYPE.IW 


C0VES.TYPfc.I79 


SYSTEM DESCRIPTION 
HELP .SYSTEM 
IROWSE EHTI R E SYSTEM 
PLOTTING ROUTINES 

I EXPLORE SURSrTSOT HISTORICAL DATA J 
PRINT CURRENT SCREEN 




Figure 2-6 

Selecting Historical Data 















C931031-U-2R06 
Page 8 


SYSTEMS INC 


ESTIMATE ATMOSPHERIC EFFECT - ATMOS PHERIC PASSES 



ISelect Historical Data" 


COVES TYPE .109 


COVES. TYPE. 108 


COVER TYPE. I ff7 


COVER .1YA1K 


COVER TY PE. IBS 


COVER . TYPE. 1M 


COVER TYPE.183 


COVER .TYPE. 103 


COVER TYPE.1B1 


COVER TYPE ! M 


COVER TYPE.] 79 


Now save the data 



Wavelengths 

( 0.58 0 . 68 ) 


( 0.73 1 . 1 ) 


Atoic sphenTHeiehr 



Du*'1ica*1E 


((0 0 ) (15 30 ) (45 30 )) 


DiicctauialP.tKttT^i.rt C «t» 


((0 0 0 . 0408 ) (15 30 0 . 0404 ) (45 30 0 . 0585 )) 


Options 

WWJUVU 


NEW. W AVEUTNCTTH 

SAVE. DAT A 

EVn.Y.M5SD«LOATA 

Qcrr 




Figure 2-7 

A Complete Set of Selected Historical Data 


Once the data has been entered, they can be saved. If the user attempts to save an 
incomplete data set, the user is prompted to supply the missing data before saving them. The 
interface allows the user to select multiple wavebands of the same historical data sample. If the 
user selects "NEW .WAVELENGTH" from the "Options" at the bottom of the "Select Historical 
Data" screen, the "Directional Reflectance Data" subwindow is cleared and highlighting of the 
previously selected waveband is removed. When the user selects a different waveband, the 
historical cover type data for the new waveband is automatically interpolated and extrapolated to the 
required view angles. The set of directional reflectance data for the new waveband is automatically 
displayed in the "Directional Reflectance Data" subwindow. The user also has the option of 
entering a different set of directional view angles for the new waveband. Selecting "QUIT" returns 
the user to the screen shown in Figure 2-3. 

When the VEG subgoal ATMOSPHERIC.CORRECTIONS is in use, platform data rather 
than ground data must be entered. The interface for entering platform data is the same as the 
interface shown in Figure 2-5, except that the atmospheric height subwindow is replaced by a 
subwindow for entering the platform height. All the cover type data sets in the current historical 
database were collected at ground level. Thus, the option of selecting data from the historical 
database for the ATMOSPHERIC.CORRECTIONS subgoal is not yet available. 
















SYSTEMS INC 


C931031-U-2R06 
Page 9 


2.2 CHARACTERIZE INPUT 

The unknown cover type data at each wavelength are characterized using code that was 
developed for the VEG subgoal SPECTRAL.HEMISPHERICAL.REFLECTANCE. Sets of view 
angles in the same azimuthal plane are identified as "strings." Strings are characterized as full- 
strings if they contain both forwardscatter and backscatter data and half-strings if they contain 
either backscatter or forwardscatter data. 


2.3 CHARACTERIZE TARGET 

If the sample data do not contain a value for ground cover or leaf area index, an estimation 
of these values is made. The code developed for the VEG subgoal SPECTRAL. 
HEMISPHERICAL.REFLECTANCE is re-used for this purpose. 


2.4 ENTER ATMOSPHERIC CONDITIONS 

When the user selects the option ENTER. ATMOSPHERIC.CONDITIONS from the menu 
shown in Figure 2-3, the screen shown in Figure 2-8 is opened. This screen allows the user to 
define the atmospheric conditions for the target data in each waveband. VEG automatically selects 
the first waveband and prompts the user to define the atmospheric conditions for that waveband. 
The user can select a standard atmosphere, such as "sub-arctic winter," by left clicking on the name 
of the standard atmosphere. The NASA GSFC technical representative was unable to provide the 
specifications of the standard atmospheres so dummy values were used for the development of this 
option. The dummy values will be replaced with the correct values when they become available. 
When a standard atmosphere has been selected, the user has the option to change the value of any 
of the atmospheric parameters as required. Alternatively, instead of selecting a standard 
atmosphere, the user can enter the value of each parameter independently. The type and range of 
each parameter value is checked after it is entered. If the user enters an invalid value, an error 
message is displayed, prompting the user to enter another value. Once a complete set of data has 
been entered, the data can be saved. If the user attempts to save an incomplete set of data he/she is 
prompted to supply the missing data before the data can be saved. After the data have been saved, 
if the target data contains more than one waveband, the prompt at the top of the screen is changed 
to include the next waveband. The values for the other parameters are not changed. The user has 
the option of changing the parameter values before saving the data for the next waveband. When 
atmospheric conditions have been saved for all the selected wavebands, the Enter Atmospheric 
Conditions Screen is automatically closed. 


SYSTEMS INC 


C931031-U-2R06 
Page 10 


ESTIMATE ATMOSPH 


Wtvdtrvgths Av«S*ble 
C63 


0.63 



^ j a to ar.V a i 1 3 H to 7.VS1 


Enter Atmospheric Conditions 


KBOBefflSBHinEE; 


For each wavelength, either choose a standard atmosphere and then modify the 
values as necessary or enter all new parameters. 

Enter the data for wavelength 0.63. 


NO CASEOUS ABSORPTION 
TROPICAL 

MIDXaTITUDESUMMIlK 


MED1ATITUIXE.WINTER 


SUB AR CT1 C SUMMER 


SUB AK CT1 r .WINTER 


US STANDARDS 


NOaEKOSOLS 


C ONTI NENT A L M OD EL 


MaRITIMEMODEX 


URBANMODLL 



Ph*st F»u, fti'ifi fArvmfTrv f»fTatf 


0.6 


360 


LWU llBUMlMi 


Svridt Sc'jrteniK’ Albedo 


0.8 


SYSTEM DESCRIPTION 
HELP 5Y STEM 
BROWSE ENTIRE SYSTEM 
PLOTT1N3 ROUTINES 

| EXPLORE SUSCrTS OF HISTORICAL BATA 
PRINT CURRENT SCREEN 



Figure 2-8 

The Enter Atmospheric Conditions Screen 


2.5 GENERATE TECHNIQUES 

Techniques can be generated automatically by the system or selected by the user. The code 
for generating techniques for the VEG subgoal SPECTRAL. HEMISPHERICAL. 
REFLECTANCE was copied and modified for this step. A new screen was created to allow the 
user to select the atmospheric passes techniques, but many existing functions were used to operate 
this screen. The NASA GSFC technical representative advised that the atmospheric techniques 
were not yet available in the appropriate format for incorporation into VEG. Thus, dummy rules 
and technique functions were incorporated in VEG at this stage. The dummy rules and functions 
should be replaced with the actual atmospheric technique rules and functions when they become 
available. 

If the user elects to have the system generate the techniques, the rules in the rulebase 
ATMOSPHERIC.PASSES. RULES are run. The rules operate on the unknown sample data at the 
wavelength level and determine the techniques that are suitable for estimating the reflectance data of 
a sample at a particular height. The names of the selected techniques are stored in the 
TECHNIQUES slot of the wavelength level unit. 

If the user elects to choose the techniques manually, the Pick Techniques screen is opened. 
When the user left clicks on the name of a dummy technique, a brief description of the technique is 
displayed. A function is called to check whether the technique is suitable for the sample. If the 
















SYSTEMS INC 


C931031-U-2R06 
Page 11 


technique is suitable for the sample, the message "Technique is suitable for this sample" is 
displayed, and the technique is selected. Otherwise, an error message is displayed in the same 
subwindow and the technique is not selected. When the user left clicks on 
PICK.SELECTED.TECHNIQUES at the bottom of the screen, the selected techniques are stored 
in the TECHNIQUES slot of the unknown cover type unit. 

Dummy rules for selecting atmospheric correction techniques were constructed in the 
ATMOSPHERIC.CORRECTIONS.RULES rulebase. An additional screen that allows the user to 
select atmospheric corrections techniques was also constructed. 

Minor changes were made to the Add Techniques interface and the code for adding 
techniques. These changes enabled the scientist to add new techniques for the subgoals 
Atmospheric Passes and Atmospheric Corrections without the assistance of the developer. The 
Add Techniques option is described in detail in Reference 3. 


2.6 RANK TECHNIQUES 

The code from the same step for the subgoal SPECTRAL. HEMISPHERICAL. 
REFLECTANCE was re-used for this step. The techniques are ranked according to a simple 
weighting scheme and the ranked techniques at each wavelength are displayed on the screen. The 
user can select the best one, two or three techniques for each wavelength, pick all the selected 
techniques, or repeat the previous step and generate the techniques again. 


2.7 EXECUTE TECHNIQUES 

The code providing the framework for this step from the VEG subgoal 
SPECTRAL.HEMISPHERICAL.REFLECTANCE was re-used for this step. Dummy functions 
for generating the coefficients and calculating the projected reflectance data for each technique were 
written. When the step EXECUTE.TECHNIQUES is selected, the techniques are applied to the 
data in the unknown cover type sample. If a technique requires coefficients, the user is asked 
whether all or half the restricted data set should be used for generating the coefficients and 
estimating the error. The appropriate coefficient methods are applied as necessary. A hierarchy of 
units is set up to hold the calculated projected reflectance data for each technique. 


2.8 OUTPUT RESULTS 

The results are displayed on the screen shown in Figure 2-9. This screen was originally 
constructed for the VEG subgoal SPECTRAL.HEMISPHERICAL.REFLECTANCE. The title 
has been changed to "Atmospheric Passes Results." The results are displayed one wavelength at a 
time. The atmospheric conditions specified for the wavelength are displayed in the subwindow 
labeled "Wavelength Results." For each technique, the name of the technique is displayed together 
with the results from applying that technique to the sample of cover type data. In Figure 2-9, the 
dummy technique B has been applied to the sample of cover type data. The results displayed for 
this technique are meaningless since technique B is a dummy technique that returns the reflectance 
value at the first view angle. When atmospheric techniques have been added to VEG, the correct 
results will be displayed on the "Output Results" screen. The user can view the results for 
different wavebands by left clicking on "NEXT. WAVELENGTH" or "PREVIOUS. 
WAVELENGTH." 



- 


M SVSTEMS INC 

u 


C931031-U-2R06 
Page 12 




ESTIMATE ATMOSPHERIC EFFECT - 


Wavelength* Available 
0-$l5 0 63 


0.915 



[Guvel ryp* NIL Sclw Zeiudi Angle 49 

Ground Cover NIL Lea) Area Index NIL Proportion Green NIL 

Dry Biomar* NIL Wet Biomass NIL Height NIL Atmospheric Height 50 


I arget char art tmeoon 

Lee! Ait* Index 3 7230 Ground Cover 09970 


W<ii/tlincTh P.entrtiUfe Date 


((0 0 0-5189) (15 30 0 5167} (60 +5 0 5207)) 


Input Atmospheric Date 

I Aerosol Optical Thichneu 1 6 Sue Dumbuoan 2 Pha*e Function Q 6 
[Ozone 38C Prtapitel Water 5 Single Scattering Albedo 08 
Date Charaaenztoor. 

No dir deta u available 
No image found 
Reautu 

Technique B Estimate 0 5189 Error 0 0000 Coehfiaentj none 




SYSTEM DESCRIPTION 
KELP SYSTEM 
JROW5E ENTIRE SYSTEM 
PLOTTING ROUTINES 

| EXPLORE SUBSETS OF HISTORICAL BATA | 
PRINT CURRENT SCREIN 


NEXT WAVELENGTH 


PREVIOUS WAVELENGTH 


QUIT 


|§ 

m 


Figure 2-9 

The Output Screen for the Subgoal ATMOSPHERIC. PASSES 













\ 

SYSTEMS INC 


C931031-U-2R06 
Page 13 


SECTION 3.0 

THE SUBGOAL CATEGORY ATMOSPHERIC TECHNIQUES IN THE VEG 

AUTOMATIC MODE 


The menus for the VEG Automatic Mode were modified to accommodate the restructuring 
of VEG subgoals into the four categories described in Section 2.0. When the user selects the 
Automatic Mode from the Processing Mode menu, the screen shown in Figure 3-1 is opened. This 
screen enables the user to select the category of subgoal for automatic processing. 


m 




m 



i§ 


Figure 3-1 

The VEG Automatic Mode Categories Menu 








SYSTEMS INC 


C931031-U-2R06 
Page 14 


When the user selects the ATMOSPHERIC.TECHNIQUES option from the screen shown 
in Figure 3-1, the "Categories" subwindow is replaced by the "Atmospheric Techniques" 
subwindow. Selecting the option ATMOSPHERIC.PASSES or ATMOSPHERIC. 
CORRECTIONS causes additional subwindows to be opened, as shown in Figure 3-2. These 
subwindows enable the user to name the input and output files, select the output file format and 
specify how many techniques should be applied to each unknown cover type data sample. 


N AS A/GSFC VEGETATION WO 


data-2-atm 


Atmocphtnc Ttthfliitues 


results aim- corr- 2 


ATMCSfflERIC PASSES 



HflV' Tt -tnu 


PICK BEST TECHNIQUE 


PICK BEST2 TECHNIQUES 


PICK BEST 3 TECHNIQUES 


PICS. ALL RANKED TECHNIQUES 


QUIT 


Processing complete 



NOT. READY 


SYSTEM DISCIw FTION 
HELP SYSTEM 
BROWSE ENTIRE SYSTEM 
PLOTTING ROUTINES 

| EXPLORE SUBSITS OF HISTORICAL DATA | 
PRINT CURRENT 5CRETN 



Figure 3-2 

Running the Subgoal ATMOSPHERIC.CORRECTIONS 
in the VEG Automatic Mode 


The input file for an atmospheric technique must contain atmospheric conditions data and 
the data platform elevation or atmospheric height as well as the cover type data that are required for 
subgoals in the other VEG categories. A standard file format for input files to atmospheric 
techniques has been defined. The file formal and an example of typical values are shown in Table 
3-3. Global variables *STANDARD-ATM-PASS-SAMPLE-FORMAT*, *STANDARD-ATM- 
CORR-SAMPLE-FORMAT* and *STANDARD-ATM-WAVELENGTH-FORMAT* have been 












33H 


C931031-U-2R06 
Page 15 


SYSTEMS INC 

” created in the file "veg-methodsl .lisp." This file contains the methods used for inputting data from 

a file into VEG. The new global variables hold the list of fields in the standard format for an 
atmospheric techniques input file. The field names correspond to the names of slots in which the 
— data should be stored. When the input file is named by the user, the values from the appropriate 

field list global variables are put in the slots AUTO.INPUT.SAMPLE. FORMAT and 
AUTO.INPUT.WAVELENGTH.FORMAT of the unit AUTOMATIC.PROCESS. When the file 
_ is read, these slots are referenced to determine the file format 


Table 3-1 

Input File Format for Atmospheric Techniques and an Example of Typical Values 


FIELD NAMES 


TYPICAL VALUES 


COVER.TYPE.DESCRIPTION 


SOLAR.ZENITH LEAF.AREA.INDEX 


GROUND.COVER PROPORTION.GREEN 


DRY.BIOMASS WET.BIOMASS HEIGHT 


DATA.PLATFORM.ELEVATION 


NUMBER.WAVELENGTHS 


WAVELENGTH 


NUMBER. VIEW.ANGLES 


REFLECT ANCE.DAT A 


AEROSOL.OPTICAL.THICKNESS 

SIZE.DISTRIBUTION 


PHASE.FUNCTION OZONE 


PRECIPITAL.WATER 
SINGLE.SCATTERING. ALBEDO 


WAVELENGTH 


NUMBER. VIEW.ANGLES 


REFLECT ANCE.DATA 


AEROSOL.OPTICAL.THICKNESS 

SIZE.DISTRIBUTION 


PHASE.FUNCTION OZONE 


PRECIPITAL.WATER 
SINGLE.SCATTERING. ALBEDO 


"Dense Vegetation Canopy" 


45 3.5 


0.7 0.3 


0.2 0.5 1000 


30 


2 


0.68 


((0 0 0.043)) 


1.6 2 


0.6 360 


5 0.8 



((0 0 0.043)) 


1.8 2 


0.6 400 


5 0.8 


When the user left clicks on "GO," the unknown cover type data are read from the file 
using the correct format. The input data and the target are then characterized as in the Research 
Mode. The rules are run, and the best techniques for the sample are selected. The selected 
techniques are then executed and the results are written to the named file using the specified format. 
The code in the file "veg-methods.lisp" that was originally written for the automatic processing of 
data for the vegetation parameter techniques was modified for the processing of data for 
atmospheric techniques. 
































SYSTEMS INC 


SECTION 4.0 
TESTING AND RESULTS 


C931031-U-2R06 
Page 16 


The following capabilities of the VEG Atmospheric Techniques subgoal category were 

tested: 

• Test 1 - Navigate through the category and subgoal menus in the Research Mode. 

• Test 2 - Atmospheric Passes Subgoal using data entered by the user 

• Test 3 - Atmospheric Passes Subgoal using historical data 

• Test 4 - Atmospheric Corrections Subgoal 

• Test 5 - Automatic Mode, Atmospheric Passes Subgoal 

• Test 6 - Automatic Mode, Atmospheric Corrections Subgoal 

• Test 7 - Add Techniques for Atmospheric Passes and Atmospheric Corrections Subgoals 

All the tests were successful, showing that the system was working correctly. The tests are 
described in detail in this section. 


4.1 TEST 1 

This test was designed to test the new sequence of menus in the VEG Research Mode that 
was implemented as a result of the subgoals being divided into categories. After left clicking on 
"RUN.VEG," the user selected the Research Mode. Because no historical data were loaded, the 
Change Historical Database screen automatically opened. The user indicated that both the Kimes 
and the Deering databases should be added. After quitting the Change Historical Database screen, 
the user again selected the Research Mode from the Processing Mode screen. The categories 
screen was then opened. The user selected the VEGETATION.PARAMETER. TECHNIQUES 
category. The Vegetation Parameters Techniques Goals screen was opened. The user then 
selected and successfully ran the Estimate Spectral Hemispherical Reflectance option before 
navigating back to the Categories menu. Subsequently, the user successfully opened and quit the 
Learning System and Atmospheric Techniques goal screens. When the user selected the 
NEURAL.NETWORK option, a message indicating that the option was not available was 
displayed. This message was removed when another option was selected. The user then 
navigated out of the VEG system back to the KEE interface. This test showed that the new menus 
were operating correctly. 


4.2 TEST 2 

Test 2 was designed to test the Atmospheric Passes Subgoal using original data entered by 
the user. The user navigated to the Atmospheric Passes main menu. The data were processed by 
carrying out the steps in the ATMOSPHERIC.PASSES menu, as shown in Figure 2-3. 

The user selected the ENTER. GROUND.DATA option, and elected to enter original data. 
The user entered various invalid values for the atmospheric height and the message "Atmospheric 
Height out of range error" was displayed in the "Messages" box. The user attempted to save an 


C931031-U-2R06 
Page 17 


SYSTEMS INC 

incomplete data set. VEG prompted the user to supply the missing data before the data set could be 
saved. Valid data for the solar zenith angle, atmospheric height, wavelength and reflectance data 
were then entered and the data were saved. Next, the input data and target were characterized. 

The interface for entering atmospheric conditions was thoroughly tested. The user entered 
invalid values for each parameter. In every case, an error message was displayed in the 
"Messages" box and the user was prompted to reenter the data. When attempting to save an 
incomplete set of atmospheric conditions data, the user was prompted to supply the missing data 
before the data could be saved. 

The user elected to select the techniques manually. The Pick Techniques screen was 
opened. When the user left clicked on a technique to select it, a description of the technique was 
displayed. If the technique was suitable for the sample, the message "Technique is suitable for this 
sample" was displayed and the technique was selected. Otherwise, an error message was 
displayed and the technique was not selected. The test showed that the Pick Techniques screen 
was operating correctly. 

The techniques were ranked and all the ranked techniques were selected. The techniques 
were then executed. The results were displayed on the screen. The atmospheric conditions were 
included in the results displayed in the "Wavelength Results" window. The results of applying the 
dummy techniques to the sample were also displayed. 

Test 2 confirmed that the subgoal "Atmospheric Passes" was operating correctly when 
original data were entered and the techniques were generated manually. 


4.3 TEST 3 

In Test 3, the Atmospheric Passes Subgoal was tested using cover type data from the 
historical cover type database. The user selected the step ENTER.GROUND.DAT A and the 
option SELECT.HISTORICAL.DATA. The Select Historical Data screen was opened. At this 
stage, only the "Message," "Option," and "Atmospheric Height" subwindows were opened. The 
user entered the value "300" into the "Atmospheric Height" subwindow. The "Cover Types" 
subwindow then opened. The user selected COVER.TYPE.7. The user then selected sun angle 
59 and waveband (0.58 0.68) in successive subwindows. The user then changed the cover type 
selection to COVER.TYPE.il. The "Wavelengths" and "Directional Reflectance" subwindows 
were automatically closed and the sun angle deselected. This part of the test showed that the data 
entry process was correctly backtracked when previously entered data were changed. The user 
reselected the previous values for cover type, sun angle and waveband. The user entered the 
directional view angles ((0 0)(15 30)(30 45)). Directional reflectance data for these view angles 
were displayed in the "Directional Reflectance Data" subwindow. The user saved the data by left 
clicking on the "SAVE.DATA" Option at the bottom of the screen. The user then selected the 
waveband (0.73 1.1) with the same view angles and saved the data. This part of the test showed 
that the Select Historical Data Screen was operating correctly. 

The data and target were then characterized. The user selected the NO.AEROSOLS 
standard atmosphere in both wavebands for the data. The techniques were generated automatically 
by running the rules. The techniques were then ranked and the best technique for each wavelength 
was selected. After the techniques had been executed, the results were displayed on the screen. 
Since the techniques were dummy, the results were not meaningful. This test showed that the 
select historical data step and the technique generation rules of the Atmospheric Passes Subgoal 
were operating correctly. 



SYSTEMS INC 

4.4 TEST 4 


C931031-U-2R06 
Page 18 


This test was designed to test the steps in the subgoal Atmospheric Corrections that were 
different from the steps in the subgoal Atmospheric Passes. The subgoal 
ATMOSPHERIC.CORRECTIONS was selected from the Atmospheric Techniques menu. The 
user selected the step ENTER. PLATFORM. DATA and then the option 
SELECT.HISTORICAL.DATA. The message "This option is not yet available" was displayed. 
The user then selected ENTER. ORIGINAL. DATA. The Enter Original Data screen opened. As 
expected, the screen included a subwindow for entering the Data Platform Elevation. The user 
entered and saved a complete set of data. 

The steps Characterize Input, Characterize Target, and Enter Atmospheric Conditions were 
then executed. Initially, the user chose to pick the techniques manually. The Pick Techniques 
screen worked correctly. The user then activated the rules to generate the techniques automatically. 
The correct techniques were selected. The techniques were then ranked and the best technique for 
each wavelength was selected. The techniques were executed and the results displayed. The 
output screen included the Data Platform Elevation in the data at the sample level. Since the 
techniques were dummies, the actual values of the results were not relevant. 

Test 4 confirmed that all the options in the subgoal Atmospheric Corrections were operating 
correctly. 


4.5 TEST 5 

This test was designed to test the new sequence of menus and the operation of the subgoal 
Atmospheric Passes in the VEG Automatic Mode. The user selected the Automatic Mode from the 
Processing Mode menu. The Automatic Mode screen with the Categories subwindow was 
opened. Tests confirmed that subgoals in the Vegetation Parameters and Learning System 
categories could be successfully operated via the new menu structure. When the user selected the 
category NEURAL.NETWORK, the message "This option is not yet available" was displayed. 

The user selected the ATMOSPHERIC. TECHNIQUES Subgoal category and the 
ATMOSPHERIC.PASSES Subgoal. The "Atmospheric Techniques," "Input File Name," "Output 
File Name," and "Number of Techniques" subwindows opened. The user entered the file name 
DATA-2-ATM as the input file and RESULTS-ATM-PASS as the output file. Standard template 
number 1 was selected as the output file format. The option to test all techniques was selected. 
When the user left clicked on "GO," the data were processed. Inspection of the output file 
indicated that the data had been processed correctly. 

This test showed that the new sequence of menus and the subgoal Atmospheric Passes 
were operating correctly in the VEG Automatic Mode. 


4.6 TEST 6 

In this test, Test 5 was repeated using the subgoal Atmospheric Corrections. Inspection of 
the output file confirmed that this subgoal was operating correctly. 


SYSTEMS INC 
4.7 TEST 7 


C931031-U-2R06 
Page 19 


The Add Techniques Option allows the scientist to define new techniques and add them to 
VEG without the assistance of the developer. Test 7 was designed to test the operation of the Add 
Techniques Option when the user attempted to add new techniques for the subgoals Atmospheric 
Passes and Atmospheric Corrections. 

Using the DEFINE.NEW.TECHNTQUE option from the Add Techniques menu, the user 
defined a new technique for each of the Atmospheric Passes and Atmospheric Corrections 
Subgoals. The user then add the new techniques to VEG using the ADD.PREVIOUSLY. 
DEFINED.TECHNIQUES option form the Add Techniques menu. Subsequently, the user ran 
both the Atmospheric Passes and the Atmospheric Corrections Subgoals. It was confirmed that the 
new techniques had been correctly incorporated in VEG. 



i! liiUiiilaa 


SYSTEMS INC 


SECTION 5.0 
CONCLUSIONS 


C931031-U-2R06 
Page 20 


l^i 


The report described the implementation of the VEG subgoal category 
ATMOSPHERIC.TECHNIQUES in both the Research and Automatic Modes of VEG. It then 
described the testing of the new components of VEG to demonstrate their basic functionality. 

The addition of Atmospheric Techniques to VEG illustrated that additional functionality can 
easily be added to the system without any major problems being encountered. The new subgoals 
Atmospheric Passes and Atmospheric Corrections were integrated into the overall VEG interface so 
that they worked smoothly as part of the overall system. The additional functionality provided by 
these new subgoals allows the scientist to take data measured at ground level and predict what the 
reflectance values would be if the data were measured at a different atmospheric height. It also 
allows atmospheric corrections to be made to data collected from an aircraft or by a satellite to 
determine what the equivalent reflectance values would be if the data were measured at ground 
level. 


i 



SYSTEMS INC 


REFERENCES 


C931031-U-2R06 
Page 21 


1. Kimes, D. S., Harrison, P. R. and Ratcliffe, P. A. 1991. A Knowledge-Based Expert 
System for Inferring Vegetation Characteristics. International Journal of Remote Sensing : 
Vol 12, 10, pp. 1987-2020. 

2. Kimes, D. S., Harrison, P. A. and Harrison, P. R. 1992. New Developments of a 
Knowledge Based System (VEG) for Inferring Vegetation Characteristics. International 
Geoscience and Remote Sensing Symposium. Houston. Texas. May 1992 . 

3. JJM Systems Inc. April 1993. An Expert System Shell For Inferring Vegetation 
Characteristics - Interface for the Addition of Techniques (Task H). Arlington, VA. 
C931021-U-2R07. 



SYSTEMS INC 


C931031-U-2R06 


APPENDIX A 

LISP CODE FOR THE VEG SUBGOAL CATEGORY ATMOSPHERIC 

TECHNIQUES 


C931031-U-2R06 
Page A-l 


;;; veg-methods6.1isp 

;;; Code for VEG Atmospheric Techniques 

;;; Created April 27, 1993 

;;; Last Modified October 18, 1993 

(in-package kee) 

(defun open-atmospheric-screen () 

"Opens the screen that allows the user to select the atmospheric technique 
goal." 

(remove.all.values 'atmospheric ’goals) 

(put. value 'atmospheric 'message "") 

(put.value 'atmospheric 'options ’view.possible.options) 

(unitmsg 'viewport-atmospheric. 1 ’open-panel!)) 


SYSTEMS INC 


*** - ” 

;;; Methods for Atmospheric Passes 

* * 


(defun atm.pass.p () 

"Returns t if the current goal is atmospheric passes and nil otherwise." 

(eq (get. value 'atmospheric 'goals) ’atmospheric.passes)) 

(defun initialize-atmospheric-screen-research () 

"Initializes the main atmospheric category screen in the VEG research mode." 
(remove.all.values 'atmospheric ’goals) 

(put. value 'atmospheric 'error. message "")) 

(defun open-atmospheric-passes-interface () 

"Opens the interface for the atmospheric passes main menu." 
(remove.all.values 'atmospheric.passes 'ap.menu) 

(unitmsg 'viewport-atmospheric.passes.l 'open-panel!)) 


;;; Methods for Atmospheric Correction 
* * * 


(defun atm.corr.p 0 

"Returns t if the current goal is atmospheric corrections and nil otherwise." 
(eq (get.value 'atmospheric ’goals) ’atmospheric.corrections)) 

(defun open-atmospheric-corrections-interface () 

"Opens the interface for the atmospheric corrections main menu." 
(remove.all.values 'atmospheric.corrections ’ac.menu) 

(unitmsg 'viewport-atmospheric. corrections.! ’open-panel!)) 



SYSTEMS INC 


C931031-U-2R06 
Page A-2 


i yy """ " """ " 

;;; Methods for Entering Original Ground Data 

5 J > - — 


(defun open-enter-ground-data-interface () 

"Opens the interface that allows the user to select between entering original 
ground data and selecting historical data." 

(put. value 'atmospheric 'error. message 
"Reinitializing the system") 

(unitmsg 'initialize.system 'initialize.system) 

(put. value 'atmospheric 'error.message "") 

(remove.all.values 'atmospheric.passes 'options) 

(remove, all. values 'estimate.hemispherical. reflectance ’current.sample) 
(remove.all.values 'estimate.hemispherical.reflectance 
'current.sample.wavelengths) 

(unitmsg 'viewport-atmospheric.passes.2 'open-panel!)) 

(defun enter-original-ground-data () 

"Opens the enter data interface, including the atmospheric height subwindow." 
(enter-original-data) 

(unitmsg 'windowpane-atmospheric.height-of-atmospheric.passes.l ’open!)) 


y » i 

;;; Methods for Entering Original Platform Data 
»»' - ' - 


(defun open-enter-platform-data-interface () 

"Opens die interface that allows the user to select between entering original 
platform data and selecting historical data." 

(put. value 'atmospheric 'error.message 
"Reinitializing the system") 

(unitmsg 'initialize.system ’initialize.system) 

(put. value 'atmospheric 'error.message "") 

(remove.all.values 'atmospheric. corrections 'options) 

(remove.all.values 'estimate.hemispherical. reflectance ’current.sample) 
(remove.all.values 'estimate.hemispherical.reflectance 
’current.sample.wavelengths) 

(unitmsg 'viewport-atmospheric. corrections.2 ’open-panel!)) 

(defun enter-original-platform-data () 

"Opens the enter data interface, including the platform elevation subwindow." 
(enter-original-data) 

(unitmsg 'windowpane-data.platform.elevation-of-atmospheric.corrections.2 
'open!)) 



SYSTEMS INC 


C931031-U-2R06 
Page A-3 


1 T ” ---- - - - ........ 

;;; Methods for Selecting Historical Ground Data 


(defun update-cover-type-window () 

"Update the cover types subwindow of the select historical ground data screen." 
(remove.all.values 'atmospheric. passes 'historical.cover.types) 

(putfacet. value 'atmospheric.passes 'historical.cover.types 'valueclass 
(cons 'one.of (get. value 'historical.cover.types ’current.cover.types))) 
(slot-image-toggle-enable 
(unit 

'windowpane-historical.cover.types-of-atmospheric.passes.2)) 

(slot-image-toggle-enable 

(unit 

’windowpane-historical.cover.types-of-atmospheric.passes.2))) 

(defun select-historical-ground-data () 

"Opens the select historical ground data screen." 

(remove.all.values 'atmospheric.passes 'directional.data) 

(put. value 'atmospheric.passes 'historical. data.options 'new.sample) 

(put. value 'atmospheric.passes 'error. message 
"Enter the atmospheric height") 

(unitmsg 'viewport-atmospheric.passes.3 'open-panel!)) 

(defun valid-directional-data (data) 

"Returns t if the directional data is valid and nil otherwise." 

(and (consp data) 

(dolist (point data t) 

(unless (and (listp point) 

(= (length point) 2)) 

(retum-from valid-directional-data nil)) 

(let ((z (zenith point)) 

(a (azimuth-360 point))) 

(unless (and (numberp z)(>= z 0)(<= z 90) 

(numbeip a)(>= a 0)(< a 360)) 

(retum-from valid-directional-data nil)))))) 

(defun get-appropriate-cover-type 0 

"Returns the name of the cover type unit at the wavelength level that has been 
selected, i.e. The descendant of the selected cover type with the selected sun 
angle and waveband." 

(let* ((this-sun (get. value 'atmospheric.passes 'sun. angles)) 

(this-waves (get.value 'atmospheric.passes 'wavelengths)) 
(this-wave-max (second this-waves)) 

(this-wave-min (first this-waves))) 

(dolist (sun (unit.children 

(get.value 'atmospheric.passes ’historical.cover.types) 
’subclass)) 

(when (= (get.value sun 'solar.zenith. angle) this-sun) 

(dolist (wave (unit.children sun ’member)) 

(when (and (= (get.value wave ’wavelength.max) this-wave-max) 

(= (get.value wave 'wavelength. min) this-wave-min)) 
(retum-from get-appropriate-cover-type wave))))))) 



C931031-U-2R06 
Page A-4 


(defun find-matching-reflectance- values (view-angles) 

"Interpolates and extrapolates the cover type data to match the entered 
directional view angles and returns a list of points, each having zenith, 
azimuth and reflectance values." 

(put. value 'atmospheric. passes 'directional.reflectance 
(match-unaltered-target-data view-angles 

(get-appropriate-cover-type)))) 


SYSTEMS INC 


(defun reset-hct-sample-data () 

"Initializes all the select historical data screen." 

(remove. all.values 'atmospheric. passes ’cover.types) 

(remove.all.values 'atmospheric. passes 'sun. angles) 

(remove.all.values 'atmospheric.passes ’wavelengths) 

(remove.all.values 'atmospheric.passes 'directional.reflectance) 

(remove.all.values 'atmospheric.passes 'atmospheric.height)) 

(defun reset-hct-wavelength-data 0 

"Initializes the wavelength and directional reflectance data in preparation for 
selection of a different wavelength in the select historical data screen." 

(remove.all.values 'atmospheric.passes 'wavelengths) 

(remove.all.values 'atmospheric.passes 'directional.reflectance) 

(put.value 'l.enter.data 'successful. save t)) 

(defun insufficient-data-hct-sample 0 

"Displays an error message because the data at the sample level is incomplete 
and hence cannot be saved.” 

(my-documentation-print 

"DATA NOT SAVED - Insufficient data - minimum data required is solar zenith, wavelength, 
directional data and atmospheric height") 

(put. value 'l.enter.data 'successful. save nil) 

(put.value 'l.enter.data 'sample. flag 'sample)) 

(defun insufficient-data-hct-wavelength () 

"Displays an error message because the data at the wavelength level is 
incomplete and hence cannot be saved." 

(my-documentation-print "DATA NOT SAVED - Insufficient data - minimum data required is 
wavelength and directional data") 

(put. value 'l.enter.data 'successful. save nil) 

(put.value 'l.enter.data 'sample.flag ’wave)) 

(defun save-hct-sample-data () 

"If sufficient data is present, calls a function to save the data at the sample 
level." 

(let ((solar- zenith (get. value 'atmospheric.passes 'sun. angles)) 

(wavelength (gel. value 'atmospheric.passes 'wavelengths)) 

(reflectance-data (get. value 'atmospheric.passes 
’directional.reflectance)) 

(atmospheric-height (get.value 'atmospheric.passes 

'atmospheric.height))) 

(if (and solar- zenith wavelength reflectance-data atmospheric-height) 
(save-hct-sample-data-aux solar-zenith wavelength reflectance-data 

atmospheric-height) 

(insufficient-data-hct-sample)))) 



JJiYi 

SYSTEMS INC 


C931031-U-2R06 
Page A-5 


(defun save-hct-sample-data-aux (solar- zenith wavelength reflectance-data 

atmospheric-height) 

"Saves the data at the sample level." 

(let ((new-sample 

(create. unit (gentemp "SAMPLE-UNKNOWN-TARGET") 

'veg 'target.data nil))) 

(put. value new-sample 'solar.zenith solar-zenith) 

(put. value new-sample 'atmospheric.height aunospheric-height) 

(put. value 'estimate.hemispherical.reflectance 'current.sample 
new-sample) 

(save-hct-wavelength-data-aux wavelength reflectance-data))) 

(defun save-hct-wavelength-data 0 

"If sufficient data is present, calls a function to save the data at the 
wavelength level." 

(let ((wavelengths (get. value 'atmospheric. passes ’wavelengths)) 
(reflectance- data (get value 'atmospheric. passes 
'directional. reflectance))) 

(if (and wavelengths reflectance-data) 

(save-hct-wavelength-data-aux wavelengths reflectance-data) 
(insufficient-data-hct-wavelength)))) 

(defun save-hct-wavelength-data-aux (wavelengths reflectance-data) 

"Saves the data at the wavelength level." 

Get* ((parent-sample 

(get. value 'estimate.hemispherical. reflectance 'current.sample)) 
(new-wavelength (create. unit (gentemp "W") 'veg nil parent-sample))) 
(put. value new-wavelength 'wavelength 

(/ (+ (first wavelengths)(second wavelengths)) 2)) 

(put. value new-wavelength 'reflectance.data reflectance-data) 

(put. value 'atmospheric.passes 'error.message "Data saved") 
(put.value 'l.enter.data 'successful. save t))) 


;;; Methods for Entering Atmospheric Data 
-- " 


(defun open-enter-atmospheric-conditions-interface () 

"Opens the interface for entering the atmospheric conditions." 
(initialize-enter-atmospheric-data) 

(put.values 'atmospheric 'wavelengths.left 
(get. values 'estimate.hemispherical.reflectance 
'current.sample. wavelengths)) 

(next-wavelength) 

(unitmsg 'viewport-atmospheric. 2 'open -panel!)) 


1^1 

SYSTEMS INC 

(defun initialize-enter-atmospheric-data () 

"Initializes the enter atmospheric conditions interface." 
(remove.all.values 'atmospheric 'standard.atmospheres) 

(remove.all. values 'atmospheric 'aerosol.optical. thickness) 
(remove.all.values 'atmospheric 'size.distribution) 
(remove.all.values 'atmospheric ’phase.function) 

(remove.all.values 'atmospheric 'ozone) 

(remove.all.values 'atmospheric ’precipital.water) 

(remove.all.values 'atmospheric 'single.scattering.albedo) 

(put. value 'atmospheric 'enter.atmospheric.data.options ’enter.data)) 


C931031-U-2R06 
Page A-6 


(defun save-atmospheric-data 0 

"If sufficient data has been entered, calls a function to save the atmospheric 
data. Otherwise displays an error message." 

(let ((current-wavelength 

(get. value 'estimate.hemispherical.reflectance 
'current, wavelength)) 

(aero (get.value 'atmospheric 'aerosol. optical. thickness)) 

(size-dist (get.value 'atmospheric ’size.distribution)) 
(phase-function (get.value 'atmospheric ’phase.function)) 

(ozone (get. value 'atmospheric 'ozone)) 

(precipital-water (get.value 'atmospheric ’precipital.water)) 
(single-scattering-albedo (get.value 'atmospheric 

'single.scattering. albedo))) 

(if (and aero size-dist phase-function ozone precipital-water 
single-scattering-albedo) 

(save-atmospheric-data-aux current-wavelength aero size-dist 

phase-function ozone 
precipital-water single-scattering-albedo) 
(insufficient-atmospheric-data)))) 

(defun save-atmospheric-data-aux (current-wavelength aero size-dist 
phase-function ozone 
precipital-water single-scattering-albedo) 

"Save the atmospheric data in the currently selected wavelength level unit." 
(put. value current-wavelength 'aerosol.optical. thickness aero) 

(put.value current-wavelength 'size.distribution size-dist) 

(puL value current-wavelength 'phase.function phase-function) 

(put. value current-wavelength 'ozone ozone) 

(put. value current-wavelength 'precipital.water precipital-water) 

(put value current-wavelength 'single.scattering.albedo 
single-scattering-albedo) 

(put.value 'atmospheric 'successful. save t) 

(next-wavelength)) 



SYSTEMS INC 


C931031-U-2R06 
Page A-7 


(defun next-wavelength () 

"Prompts the user to enter atmospheric data at the next wavelength or closes 
the screen is all wavelengths have been processed." 

(let ((new-wavelength (get. value 'atmospheric 'wavelengths.left))) 

(cond ((null new-wavelength) 

(quit-enter-atmospheric-conditions-interface)) 

(t (remove.value 'atmospheric 'wavelengths.left new-wavelength) 

(put. value 'estimate.hemispherical.reflectance 'current. wavelength 
new-wavelength) 

(put. value 'atmospheric 'error.message (format () 

"For each wavelength, either choose a standard atmosphere and then modify the values as 
necessary or enter all new parameters. Enter the data for wavelength ~S." 

(get. value new-wavelength ’wavelength))))))) 

(defun quit-enter-atmospheric-conditions-interface 0 
"Closes the enter atmospheric conditions interface." 

(put. value 'atmospheric 'error.message "") 

(unitmsg 'viewport- atmospheric. 2 ’close-panel!) 

(put.value 'atmospheric 'done.enter.atmospheric.conditions.p t) 

(when (get.value 'estimate.hemispherical.reflectance ’select.all) 
(open-generate-techniques-interface))) 

(defun insufficient-atmospheric-data () 

"Displays an error message if insufficient atmospheric data has been entered." 
(my-documentation-print 

"DATA NOT SAVED - Insufficient data - all boxes must be filled before data can be saved") 
(put.value 'atmospheric 'successful.save nil)) 

(defun set-up-standard-atmosphere (name) 

"Sets up the correct arguments and calls a function to assign the correct slot 
values for a standard atmosphere. This function is a dummy at present. It should 
be replaced by the correct descriptions of standard atmospheres when they are 
available." 

(case name 

(no.gaseous.absorption (set-up-standard-atmosphere-aux 1 2 0.5 300 5 0.8)) 

(tropical (set-up-standard-atmosphere-aux 1.2 2 0.6 350 5 0.8)) 

(mid.latitude.summer (set-up-standard-atmosphere-aux 1.3 2 0.6 350 5 0.8)) 

(mid.latitude. winter (set-up-standard-atmosphere-aux 1.4 2 0.6 360 5 0.8)) 

(sub.arctic.summer (set-up-standard-atmosphere-aux 1.5 2 0.6 370 5 0.8)) 

(sub.arctic.winter (set-up-standard-atmosphere-aux 1.6 2 0.6 380 5 0.8)) 

(us.standard.62 (set-up-standard-atmosphere-aux 1.7 2 0.6 390 5 0.8)) 

(no.aerosols (set-up-standard-atmosphere-aux 1 .8 2 0.6 400 5 0.8)) 

(continental. model (set-up-standard-atmosphere-aux 1.9 2 0.6 250 5 0.8)) 

(maritime.model (set-up-standard-atmosphere-aux 2 2 0.6 260 5 0.8)) 

(urban.model (set-up-standard-atmosphere-aux 2.1 2 0.6 270 5 0.8)))) 


SYSTEMS INC 


C931031-U-2R06 
Page A- 8 


(defun set-up-standard-atmosphere-aux (aero size-dist phase-function ozone 

precipital-water 

single-scattering-albedo) 

"Assigns the appropriate slot values for a standard atmosphere." 

(put. value 'atmospheric 'aerosol.optical. thickness aero) 

(put value 'atmospheric 'size.distribulion size-dist) 

(put. value 'atmospheric 'phase.function phase-function) 

(put. value 'atmospheric 'ozone ozone) 

(put value 'atmospheric 'precipital. water precipital-water) 

(put.value 'atmospheric 'single.scattering.albedo single-scattering-albedo)) 


? 1 1 ------ - 

;;; Methods for Generating Atmospheric Passes Techniques 


m 


(defun user-pick-atm-pass-techniques 0 

"Opens the interface that selects each wavelength in turn to allow the user to 
select atmospheric passes techniques." 

(unitmsg 'viewport-6.generate. techniques. 3 'open-panel!) 

(dolist (thisunit (get. values 'estimate.hemispherical.reflectance 
’current.sample.wavelengths) 
(all-generate-techniques-fmished-message)) 

(put.value 'estimate.hemispherical.reflectance 'current wavelength 
thisunit) 

(user-pick-atm-pass-techniques-aux) 

(remove.all.values '6.generate.techniques ’push.button) 
(wait-for-mouse-gt))) 

(defun user-pick-atm-pass-techniques-aux 0 

"Opens the interface to allow the user to select atmospheric passes 

techniques." 

(reset-initial-values-pick-atm-pass-techniques) 

(unitmsg 'viewport-atmospheric.passes.4 ’open-panel!)) 

(defun reset-initial-values-pick-atm-pass-techniques 0 
"Initializes the user pick atmospheric passes techniques screen." 
(remove.all.values 'atmospheric. passes ’selected.techniques) 

(put. value '6.generate. techniques 'error.message "") 

(put. value '6.generate.techniques 'description. of.technique "") 

(put.value 'atmospheric. passes 'action. on.selecting.techniques 
'select, techniques)) 

(defun pick-selected-values-atm-pass () 

"Stores the selected atmospheric passes techniques in the correct wavelength 
level unit and displays a list of the selected techniques." 

(let ((techs (get.values 'atmospheric. passes 'selected.techniques)) 
(current-wave (get. value 'estimate.hemispherical.reflectance 
'current, wavelength))) 

(unless (null current-wave) 

(put. values current-wave 'techniques techs)) 

(tech-message (format () 

"Techniques selected for the sample at wavelength ~S are:— { ~S~}" 
(wav current-wave) (get-unil-names techs))))) 



C931031-U-2R06 
Page A-9 


SYSTEMS INC 


1*5 ” ” ------ - - 

;;; Methods for Generating Atmospheric Corrections Techniques 


£ ^ 


113 


Pi 


(defun user-pick-atm-corr-techniques () 

"Opens the interface that selects each wavelength in tum to allow the user to 
select atmospheric corrections techniques." 

(unitmsg 'viewport-6. generate. techniques.3 'open-panel!) 

(dolist (thisunit (get. values 'estimate.hemispherical.reflectance 
'current.sample.wavelengths) 
(all-generate-techniques-fmished-message)) 

(put. value 'estimate.hemispherical.reflectance 'current. wavelength 
thisunit) 

(user-pick-atm-corr-techniques-aux) 

(remove. all.values '6.generate.techniques 'push. button) 
(wait-for-mouse-gt))) 

(defun user-pick-atm-corr-techniques-aux 0 

"Opens the interface to allow the user to select atmospheric corrections 
techniques." 

(reset-ini tial-values-pick-atm-corr-techniques) 

(unitmsg 'viewport-atmospheric.corrections.3 'open-panel!)) 

(defun reset-ini tial-values-pick-atm-corr- techniques 0 
"Initializes the user pick atmospheric corrections techniques screen." 
(remove.all.values 'atmospheric.corrections 'selected.techniques) 

(put. value '6.generate.techniques 'error.message "") 

(put. value '6.generate.techniques 'description.of.technique '"') 

(put.value 'atmospheric.corrections 'action.on.selecting.techniques 
'select, techniques)) 

(defun pick-selected-values-atm-corr () 

"Stores the selected atmospheric corrections techniques in the correct 
wavelength level unit and displays a list of the selected techniques." 

Qet ((techs (get. values 'atmospheric.corrections 'selected.techniques)) 
(current-wave (get value 'estimate.hemispherical.reflectance 
'current, wavelength))) 

(unless (null current-wave) 

(put values current-wave 'techniques techs)) 

(tech-message (format () 

"Techniques selected for the sample at wavelength ~S are:-~{ ~S~}" 
(wav current-wave) (get-unit-names techs))))) 

m””"*"""""**’""""""’"""””"’ ----- --------------------- 

;;; Select all options for atmospheric techniques 

555 ----------- - — - — — - — - 


(defun select-all-atm-options () 
(determine-atm-starting-point-and-start) 

(put. value 'estimate. hemispherical. reflectance 'select.all t)) 



SYSTEMS INC 


C931031-U-2R06 
Page A- 10 


(defun determine-atm-starting-point-and-start 0 
(cond ((not (get. value 'estimate.hemispherical.reflectance 
'done.enter.data.p)) 

(if (atm.pass.p) 

(open-enter-ground-data-in terface) 

(open-enter-platform-data-in terface))) 

((not (get. value 'estimate.hemispherical.reflectance 
'done.characterize.input.p)) 
(open-characterize-input-interface)) 

((not (get. value 'estimate.hemispherical.reflectance 
'done.characterize.target.p)) 
(open-characterize-target-interface)) 

((not (get. value 'atmospheric ’done.enter.atmospheric.conditions.p)) 
(open-enter-atmospheric -conditions-in terface)) 

((not (get. value 'estimate.hemispherical.reflectance 
'done.generate.techniques.p)) 
(open-generate-techniques-interface)) 

((not (get. value 'estimate.hemispherical.reflectance 
'done.rank.techniques.p)) 

(open- rank-techniques- interface)) 

((not (get.value 'estimate.hemispherical.reflectance 
'done.execute.techniques.p)) 

(open-execute-techniques-in terface)) 

(t (open-output-results-interface)))) 



IUASA 

Naixr.3' Aeronauts a-c 

Severe Aiyn*r>5i'3ror 


Report Documentation Page 



2. Government Accession No. 


4. Title and Subtitle 


An Expert System Shell for Inferring Vegetation Characteristics - 
Atmospheric Techniques (Task G) 


3. Recipient's Catalog No. 


5. Report Date 

October 1993 


6. Performing Organization Code 


7. Author(s) 

P. Ann Harrison and Patrick R. Harrison 


8. Performing Organization Report No. 

C931031-U-2R06 


9. Performing Organization Name and Address [ 

JJM Systems, Inc. 

One Ivybrook Blvd., Suite 190 
Ivyland, PA 18974 


12. Sponsoring Agency Name and Address 

National Aeronautics and Space Administration 
Washington, DC 20546-0001 
NASA/Goddard Space Right Center 
Greenbelt, MD 20771 


15. Supplementary Notes 

The Lisp and KEE code for this work is available on a Sun Cartridge Tape. 


10. Work Unit No. 

462-61-14 


11. Contract or Grant No. 

NAS5-30127 


13. Type of Report and Period Covered 

Task Report for Task G 
April - October 1993 


14. Sponsoring Agency Code 


16. Abstract 

The NASA VEGetation Workbench (VEG) is a knowledge based system that infers vegetation 
characteristics from reflectance data. The VEG Subgoals have been reorganized into categories. A 
new subgoal category "Atmospheric Techniques" containing two new subgoals has been 
implemented. The subgoal Atmospheric Passes allows the scientist to take reflectance data 
measured at ground level and predict what the reflectance values would be if the data were 
measured at a different atmospheric height. The subgoal Atmospheric Corrections allows 
atmospheric corrections to be made to data collected from an aircraft or by a satellite to determine 
what the equivalent reflectance values would be if the data were measured at ground level. The 
report describes the implementation and testing of the basic framework and interface for the 
Atmospheric Techniques Subgoals. 


17. Key Words (Suggested by Author(s)) 


EXPERT SYSTEM, ARTIFICIAL 
INTELLIGENCE, REMOTE SENSING 


18. Distribution Statement 


UNCLASSIFIED - UNLIMITED 


19. Security Classif. (of this report) 

UNCLASSIFIED 


NASA FORM 1626 OCT 86 


20. Security Classif. (of this page) 

UNCLASSIFIED 


21 . No of pages 


22. Price 


For sale by the National Technical Information Service, Springfield, VA 22161-2171 

















