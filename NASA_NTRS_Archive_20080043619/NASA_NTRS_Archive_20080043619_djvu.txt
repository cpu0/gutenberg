NASA/TM— 2008-2 15303 


AIAA-200 8^1579 



A Modular Aero-Propulsion System Simulation 
of a Large Commercial Aircraft Engine 


Jonathan A. DeCastro 

Impact Technologies, LLC, Rochester, New York 
Jonathan S. Lift 

Glenn Research Center, Cleveland, Ohio 
Dean K. Frederick 

Saratoga Control Systems, Inc., Saratoga Springs, New York 


September 2008 


NASA STI Program ... in Profile 


Since its founding, NASA has been dedicated to the 
advancement of aeronautics and space science. The 
NASA Scientific and Technical Information (STI) 
program plays a key part in helping NASA maintain 
this important role. 

The NASA STI Program operates under the auspices 
of the Agency Chief Information Officer. It collects, 
organizes, provides for archiving, and disseminates 
NASA’s STI. The NASA STI program provides access 
to the NASA Aeronautics and Space Database and 
its public interface, the NASA Technical Reports 
Server, thus providing one of the largest collections 
of aeronautical and space science STI in the world. 
Results are published in both non-NASA channels 
and by NASA in the NASA STI Report Series, which 
includes the following report types: 

• TECHNICAL PUBLICATION. Reports of 
completed research or a major significant phase 
of research that present the results of NASA 
programs and include extensive data or theoretical 
analysis. Includes compilations of significant 
scientific and technical data and information 
deemed to be of continuing reference value. 
NASA counterpart of peer-reviewed formal 
professional papers but has less stringent 
limitations on manuscript length and extent of 
graphic presentations. 

• TECHNICAL MEMORANDUM. Scientific 
and technical findings that are preliminary or 
of specialized interest, e.g., quick release 
reports, working papers, and bibliographies that 
contain minimal annotation. Does not contain 
extensive analysis. 

• CONTRACTOR REPORT Scientific and 
technical findings by NASA-sponsored 
contractors and grantees. 


papers from scientific and technical 
conferences, symposia, seminars, or other 
meetings sponsored or cosponsored by NASA. 

• SPECIAL PUBLICATION. Scientific, 
technical, or historical information from 
NASA programs, projects, and missions, often 
concerned with subjects having substantial 
public interest. 

• TECHNICAL TRANSLATION. English- 
language translations of foreign scientific and 
technical material pertinent to NASA’s mission. 

Specialized services also include creating custom 

thesauri, building customized databases, organizing 

and publishing research results. 

For more information about the NASA STI 

program, see the following: 

• Access the NASA STI program home page at 
http://www.sti.nasa.gov 

• E-mail your question via the Internet to he!p@ 
sti.nasa.gov 

• Fax your question to the NASA STI Help Desk 
at 301-621-0134 

• Telephone the NASA STI Help Desk at 
301-621-0390 

• Write to: 

NASA Center for AeroSpace Information (CASI) 
7115 Standard Drive 
Hanover, MD 21076-1320 


CONFERENCE PUBLICATION. Collected 


NASA/TM— 2008-2 15303 


AIAA-200 8^1579 



A Modular Aero-Propulsion System Simulation 
of a Large Commercial Aircraft Engine 


Jonathan A. DeCastro 

Impact Technologies, LLC, Rochester, New York 
Jonathan S. Lift 

Glenn Research Center, Cleveland, Ohio 
Dean K. Frederick 

Saratoga Control Systems, Inc., Saratoga Springs, New York 


Prepared for the 

44th Joint Propulsion Conference and Exhibit 
cosponsored by AIAA, ASME, SAE, and ASEE 
Hartford, Connecticut, July 21-23, 2008 


National Aeronautics and 
Space Administration 


Glenn Research Center 
Cleveland, Ohio 44135 


September 2008 


Acknowledgments 


The authors wish to acknowledge Don Simon of NASA Glenn Research Center for his contributions in the development 
of the steady state solver, Shreeder Adibhatla of General Electric Aircraft Engines for many informative discussions on 
engine control, N&R Engineering, Inc., for facilitating the controller development, Sanjay Garg of NASA Glenn for 
his vision and support in the creation of C-MAPSS, and the NASA Aviation Safety Program 
Integrated Resilient Aircraft Control Project for funding this work. 


Trade names and trademarks are used in this report for identification 
only. Their usage does not constitute an official endorsement, 
either expressed or implied, by the National Aeronautics and 
Space Administration. 


Level of Review. This material has been technically reviewed by technical management. 


Available from 


NASA Center for Aerospace Information 
7115 Standard Drive 
Hanover, MD 21076-1320 


National Technical Information Service 
5285 Port Royal Road 
Springfield, VA 22161 


Available electronically at http://gltrs.grc.nasa.gov 


A Modular Aero-Propulsion System Simulation of a 
Large Commercial Aircraft Engine 


Jonathan A. DeCastro 
Impact Technologies, LLC 
Rochester, New York 14623 

Jonathan S. Litt 

National Aeronautics and Space Administration 
Glenn Research Center 
Cleveland, Ohio 44135 

Dean K. Frederick 
Saratoga Control Systems, Inc. 

Saratoga Springs, New York 12866 

Abstract 

A simulation of a commercial engine has been developed in a graphical environment to meet the 
increasing need across the controls and health management community for a common research and 
development platform. This paper describes the Commercial Modular Aero Propulsion System 
Simulation (C-MAPSS), which is representative of a 90,000-lb thrust class two spool, high bypass ratio 
commercial turbofan engine. A control law resembling the state-of-the-art on board modem aircraft 
engines is included, consisting of a fan-speed control loop supplemented by relevant engine limit 
protection regulator loops. The objective of this paper is to provide a top-down overview of the complete 
engine simulation package. 

Nomenclature 

e solver error 

HPC high pressure compressor 

HPT high pressure turbine 

J solver Jacobian 

LPC low pressure compressor 

LPT low pressure turbine 

MM model matching control design scheme 

MN Mach number 

A; fan speed 

N\ corrected fan speed 

N 2 core speed 

N§ corrected core speed 

P, pressure at station i 

PR pressure ratio 

SM stall margin 

Tj temperature at station i 

TRA throttle resolver angle 


NASA/TM— 2008-215303 


1 



VBV 

variable bleed valve 

VSV 

variable stator vane 

Wf 

fuel flow 

Wt 

flow at station i 

X 

solver state 

<Pf 

corrected mass flow rate at station i 


adiabatic efficiency 


I. Introduction 

There is great interest in the development of advanced control and health management algorithms for 
aircraft turbofan engines. However, a practical yet realistic non-proprietary simulation of a commercial 
turbofan engine did not previously exist on which to develop these algorithms. This has been a barrier to 
progress, especially in regard to collaboration between NASA researchers and their counterparts in 
academia and industry who must develop their new technologies in a realistic test-bed. Previously, a 
NASA-developed generic military turbofan engine simulation, the Modular Aero-Propulsion System 
Simulation (MAPSS), had been released for public use as a means to rapidly implement and test control 
algorithms on a validated engine model (ref. 1). Since then, other industrial and military gas turbine 
models tailored for controls and diagnostics research have been described in some recent papers as 
platforms in support of various programs (refs. 2 to 5). However, most of these are not available to the 
general public. Because many problems of interest are directly applicable to the commercial platform, 
there remains a strong need for a common non-proprietary commercial engine simulation from those in 
the community. Indeed, the differences between the commercial and military platforms are significant. 
Aside from the obvious differences in thermodynamic operation, the actuators, sensors, time constants, 
controller, and solution method are categorically dissimilar. 

The Commercial Modular Aero-Propulsion System Simulation (C-MAPSS) has been developed in 
the Matlab/Simulink (The Mathworks, Inc.) environment as a multifunctional simulation of a large 
commercial turbofan engine with a realistic engine control system. The engine represents a modem dual- 
spool, high-bypass ratio turbofan engine of the type on which many controls and diagnostics/health 
management studies have concentrated in recent years. The key function of C-MAPSS is to provide the 
user with a graphical turbofan engine simulation environment in which advanced algorithms can be 
implemented and tested. The software provides the user easy access to health, control, and engine 
parameters through a graphical user interface (GUI). A controller that is representative of the control logic 
within a Full Authority Digital Engine Controller (FADEC) on board current commercial engines is also 
part of the package. 

The C-MAPSS paradigm provides functionality for the following: engine initialization at arbitrary 
(valid) flight conditions in the flight envelope, generation of linear point models at operating conditions 
for system analysis and design, design of linear point compensators, and rapid generation of closed-loop 
simulations and visualization of the results. All of these capabilities have been automated for the end user 
through use of the Matlab GUI environment. The usually tedious task of constructing a gain-scheduled 
controller, for example, may be greatly facilitated by the GUI’s built-in capabilities. To be specific, the 
design of a point controller, as an elemental part of the gain-scheduled controller, is consolidated into a 
point-and-click operation that leverages the data capture/retrieval capabilities of Matlab. The basic 
features are supplemented with capabilities to simulate effects such as engine deterioration or faults by 
adjustment of the health parameter modifiers, as is common practice. 

Each of the basic engine components has been coded as a Simulink s-function script (a computer 
program, interpreted or compiled, written in one of several standard programming languages within a 
Simulink block), which brings several advantages including execution speed and line-by-line 
validation/modification. Owing to the Matlab/Simulink environment in which it was developed, the 
model is capable of being eventually deployed (all or in part) as compiled code for hardware-in- the-loop 


NASA/TM— 2008-215303 


2 



applications such as flight simulators and other real-time validation studies. This would require further 
development, and is not within the scope of this paper. 

It should be noted that C-MAPSS has been made available as an initial release (version 1.0) through 
the NASA Glenn Software Repository website (http://technology.grc.nasa.gov/software/ ) and has 
been reported in reference 6. A more recent version that has been developed (to be designated version 2.0 
in a possible future release) is the focus of this paper. The second version differs from the first release in a 
number of areas. First, several new model features have been added. These include actuator and sensor 
dynamics, variable geometry effects, Reynolds’ number effects (in the high pressure compressor), and 
representation of the combustion transport delay. Changes have been made to the gain-scheduled 
controller structure and implementation of the limit logic. Several improvements have been made to the 
GUI to offer the user greater flexibility in performing the built-in functions in a more streamlined manner. 

The following sections outline the basic engine model from a top-down perspective. Section II 
presents important details of the C-MAPSS engine and provides some scope of the modeling techniques 
used for this engine system. Implementation details of the aero-thermodynamic model, the solution 
method, and the control logic are described in Section III. A simple flight scenario example, highlighting 
aspects of the simulation’s functionality as a controls and diagnostics development and prototyping tool, 
is presented in Section IV. Section V summarizes the C-MAPSS program. 

II. Overview of the C-MAPSS Engine Platform 

The C-MAPSS engine represents a conceptual 90,000-lb thrust class turbofan engine with high- 
bypass ratio and a two-spool configuration. Figure 1 shows the various components of the engine. The 
five rotating components consist of the fan, low pressure compressor (LPC), and low pressure turbine 
(LPT) on the fan shaft, and the high pressure compressor (HPC) and high pressure turbine (HPT) on the 
core shaft. The station designations are shown along the bottom of the figure. To give some perspective 
for size, the engine has been designed to operate with a bypass ratio (BPR) of 8.4, an overall pressure 
ratio (OPR) of 36, and has a fan diameter of approximately 100 in. The design speeds for the fan and core 
shafts are 2450 and 9300 rpm, respectively. The control inputs to this engine are fuel flow ( Wj ), variable 
stator vane (VSV) angle, and variable bleed valve (VBV) position. Two spool rotation and six gas path 
sensors are considered as inputs to the control logic: N\, N 2 , P 20 , T 20 , T 2 4 , P.s’30, T 48 , and /Vo. This is 
representative of the sensors, in terms of type and quantity, used in most commercial turbofan engines. 



Figure 1. — Diagram of the C-MAPSS engine components and station designations. 


NASA/TM— 2008-215303 


3 


The component maps and other parametric data have been generated at NASA using a variety of 
high-fidelity sources. The map data are loaded at startup from Matlab script files, which are then read as 
global variables at the component s-function level. As such, the simulation is easy to adapt with different 
cycle deck data representative of different turbofan engines. The model has been constructed to ensure 
steady-state validity over altitudes ranging from sea level to 40,000 ft, Mach numbers (MN) between zero 
and 0.85, and sea-level temperatures between -60 and 103 °F. Details of the implementation are 
discussed in the remainder of the paper. 


III. Description of the Engine Model and Control System 

This section is devoted to providing the reader with an understanding of the formulation and 
construction of the aero-thermodynamic model and control system. In addition to providing an overview 
of the modeling method, this section details the conventions used for modeling physical features such as 
stall margin, health parameters and component maps. Detailed accounts of the thermodynamic models for 
gas turbines can be found elsewhere in the literature (refs. 7 to 10). 

A. Aero-Thermodynamic Model 

In order to capture the essential thermodynamic effects of the five rotating components, each has been 
represented by maps relating pressure ratio, corrected flow rate, and adiabatic efficiency, which are 
indexed by corrected shaft speed. The procedure and conventions for correcting gas path flow rates W and 
spool speeds are well known and well documented (see ref. 11). The corrected mass flow rates are 
designated by “cp” and the corrected versions of the two spool speeds are designated “ N\ ” and “ N§ .” 

The model operates with thermodynamic parameters that vary with temperature and gas composition. 
When computing these parameters, it is assumed that the combustion is complete with no unbumed 
combustion products. The polytropic coefficient, for example, is calculated based on the gas temperature 
and fuel-to-air ratio (FAR). The universal gas constant is computed based only upon the fuel-to-air ratio. 

Atmospheric Mode 

In order to represent altitude-adjusted air properties, the C-MAPSS package includes an atmospheric 
model consisting of an altitude-adjusted free-stream temperature. For researchers intending to integrate C- 
MAPSS with an airframe model, the atmospheric model can be replaced with the aircraft atmospheric 
model to maintain consistency. 

Inlet 

The simple model of the inlet consists of a total pressure and temperature computation that is 
corrected to account for ram pressure recovery. Since C-MAPSS only operates in the subsonic regime, 
ram recovery typically stays above 99.5 percent. 

Fan and Compressors 

In the fan and compressors, the torque supplied by the shaft is used to compress the flow. The fan, 
low pressure compressor (LPC) and high pressure compressor (HPC) are each represented by a 
performance map that is described by three quantities: pressure ratio (PR), cp, and adiabatic efficiency (q). 
These maps are indexed by shaft speed and R-line. The independent variable R-line is used instead of PR 
simply because compressor maps take on a profile such that a given PR may correspond to more than one 
corrected flow value at a constant corrected speed. An R-line value of 1.0 corresponds to the stall line and 
an R-line of 2.0 corresponds to the intersection with the design point. Inter-stage bleeds representing air 
extracted for customer service, preferential cooling, and overboard bleed have been included as fractional 
flow debits on the core stream. These have been assumed to be localized at the compressor exit (9 th stage), 
which is a reasonable approximation to make even though the actual bleeds may occur, in some cases, 


NASA/TM— 2008-215303 


4 



several stages upstream. Table 1 shows the design-point characteristics of the fan and compressors, which 
gives the generalist an idea of the size of each component, and may be used as a basis for scaling the 
entire map to assume the form of a different engine cycle. 


TABLE 1.— FAN/COMPRESSOR/TURBINE 
DESIGN POINT CHARACTERISTICS 


Component 

Parameter 

Value 

Fan 

All 

R-line^m 

P^Fan 

hFan 

(PFan 

2654 rpm 
2.0 
1.784 
0.8969 
3655.5 lbm/s 

Low Pressure 
Compressor 

tv, 

R-liue L pc 

PRlpc 

Ulpc 

<Plpc 

2654 rpm 
2.0 

1.1035 
0.9148 
289.57 lbm/s 

High Pressure 
Compressor 

n 2 

R-line n p C 

PR HPC 

Uhpc 

<Phpc 

9210 rpm 
2.0 

21.817 
0.8615 
209.47 lbm/s 

High Pressure 
Turbine 

n 2 

PRhft 

Uhpt 

<Phpt 

91 19 rpm 
4.239 
0.9202 
17.59 lbm/s 

Low Pressure 
Turbine 

tv, 

PR LPT 

Ulpt 

<Plpt 

2394 rpm 

5.858 

0.930 

94.64 lbm/s 


Combustor 

The fuel delivery and combustion process is modeled by a 40-ms transport delay, in conjunction with 
a slight flow resistance due to losses at the liner and mixer. The model of the heat release process is 
simplified by assuming that the combustion process is stoichiometric (i.e. no unburned hydrocarbons 
remain). 

Turbines 

As with the compressors, the turbines are represented by maps relating shaft speed to cp and r|, 
however since the relationship between PR and (p is unique, PR is used as the other independent variable 
(in addition to shaft speed) for indexing the maps. The energy of the gas flow produces work on the shaft, 
thereby driving the associated fan and compressors. In the HPT and LPT, the cooling bleed flows re-enter 
the gas stream with a substantial pressure drop due to the cooling passages through which they pass. The 
map characteristics at the design point for the HPT and LPT are given in table 1 . 

Nozzles 

The core and bypass nozzles are modeled as adiabatic expansion processes. The core and bypass are 
subsonic in nature, which calls for a converging nozzle design. Standard subsonic compressible flow 
relationships are used to represent the expansion process. 


NASA/TM— 2008-215303 


5 




Shaft Dynamics 

The fan and core shaft dynamics are governed by the conservation angular momentum, where the 
sum of the shaft torques is proportional to the angular acceleration (derivative of the shaft speed, or Ndot). 
The lumped shaft inertia governs the acceleration and deceleration of the shaft. The moments of inertia 
for the low- and high-speed rotors are 533 and 47.7 ft-lb-s 2 , respectively. 

Duct Losses 

At the exit of each component, a small pressure drop is inserted to represent the frictional losses due 
to the duct walls lumped at a discrete location. 

Variable Bleed Valve 

The primary purpose of the VBV is to avoid compressor instability, namely to prevent the compressor 
from entering stall at an operating condition. As stated above, bleeds are usually modeled as fractional 
flow extractions from the primary flow. The VBV is capable of actuating a large percentage of the core 
flow to the bypass duct and must also modulate the flow path at moderate to high power settings, meaning 
that the flow will be choked under certain conditions. For this reason, the VBV cannot be modeled as a 
proportional orifice, and is instead modeled using isentropic compressible flow principles, under the 
assumption of ideal converging- diverging nozzle flow. 

Variable Stator Vanes 

The VSV are typically located at the forward stages of the HPC and are used as a means to maintain 
compressor stability and prevent choking of the downstream compressor stages. In the HPC, the VSV 
effects have been represented by nonlinear modifications to the baseline component maps. The HPC maps 
were generated with the stator vanes operating on a control schedule; therefore the delta values from this 

schedule have been approximated from compressor data that is a function of corrected core speed W? 
and vane angle. The compressor PR, (p and r| maps are thus formulated in terms of elemental maps of 
flow coefficient, isentropic work and actual work. With this representation, the effects of the VSV angle 
have a multiplicative (scalar) influence and are easily incorporated. 

Stall Margin 

Stall margins (*W Fan , SM LPC , .S'/V/ m . c ) are computed by comparing the actual pressure ratio to the 
pressure ratio at the stall line for the same corrected flow rate. On a compressor map, this is geometrically 
visualized as the vertical difference between the current operating point and the stall line. 

Health Parameters 

Health parameters are useful adjustments to a simulation for representation of damage, deterioration, 
or a fault condition. In gas-path health-management research, these parameters are essential for studying 
detection and/or isolation of faults or deterioration. As shown in table 2, there are 13 health parameters, 
each corresponding to an adjustment to the map parameters in a rotating component. In the fan and each 
of the compressor routines, there are three health parameters corresponding to a percent corrected flow 
rate, pressure ratio, or efficiency “delta” relative to the nominal value. Degradation can be approximated 
by incorporating a steady-state adjustment to the health parameters; a fault can be simulated by imposing 
a time-dependent shift in the health parameter, by specifying the time-dependent profile that characterizes 
the fault. 


NASA/TM— 2008-215303 


6 



TABLE 2.— HEALTH PARAMETERS 



Parameter 

Description 

1 

"H mod, Fan 

Fan efficiency modifier 

2 

mod, Fan 

Fan corrected flow modifier 

3 

-^-^mod.Fan 

Fan pressure ratio modifier 

4 

PmodXPC 

LPC efficiency modifier 

5 

(PmodXPC 

LPC corrected flow modifier 

6 

TRmod.LPC 

LPC pressure ratio modifier 

7 

Omod.HPC 

HPC efficiency modifier 

8 

<Pmod,HPC 

HPC corrected flow modifier 

9 

TR m od.HPC 

HPC pressure ratio modifier 

10 

'lmod.HPT 

HPT efficiency modifier 

11 

(Pmod.HPT 

HPT corrected flow modifier 

12 

OmodXPT 

LPT efficiency modifier 

13 

(Pmod.LPT 

LPT corrected flow modifier 


Actuator and Sensor Dynamics 

The dynamics of several actuators and sensors have been included in the simulation. The fuel 
metering valve (FMV) actuator, along with the VSV and VBV servoactuators have been modeled by 
simple first-order transfer functions, which is a valid approach to use for sample rates as slow as the 
controller rate. For the VBV and VSV, the actuator commands are open-loop scheduled on corrected fan 
and core speeds, respectively. The bleed valve is scheduled such that the valve is fully open at low power 
and closed at moderate-to-high power settings. The variable stators are commanded a positive deflection 
(50°) at low power and move to zero deflection at high settings. As with the actuators, the sensors are also 
taken as first-order lags, whose bandwidth parameters are given in table 3. 


TABLE 3.— ACTUATOR AND SENSOR 
DESCRIPTIONS AND BANDWIDTHS 


Variable 

Description 

Bandwidth 

Wf 

Fuel metering valve 

25 rad/s 

VBV 

Variable bleed valve 

23 rad/s 

VSV 

Variable stator vanes 

23 rad/s 

Ni 

Fan speed 

50 rad/s 

n 2 

Core speed 

50 rad/s 

Tio 

Fan inlet temperature 

9 rad/s 

P 20 

Fan inlet pressure 

25 rad/s 

T 24 

LPC outlet temperature 

9 rad/s 

PS 30 

Combustor static pressure 

25 rad/s 

As 

HPT exhaust gas temp. 

9 rad/s 

P 50 

Core exhaust pressure 

25 rad/s 


It should be evident at this point that the physical engine system represented here is fairly 
comprehensive in scope. Although three-dimensional flow effects have been eliminated, the effects of 
heat soakage and tip clearance have not been incorporated, and some simplifying assumptions have been 
made, the gross aero-thermodynamic effects remain intact. As such, the resulting model is useful for 
examining important gas-path-related effects of interest for control law or health management system 
developers. 


B. The Engine Balance Solver Routine 

The engine has two physical state variables: fan speed and core speed (with respective time constants 
governed by rotor inertia). The fan, two compressors and two turbines each possess one u nk nown 
variable: for the fan and compressors this is the R-line value, for the turbines it is pressure ratio. An 


NASA/TM— 2008-215303 


7 





iterative solver is used to drive down the flow continuity errors between each of the five major 
components in order to uniquely solve the five u nk nowns. Although it is more accurate to iterate until a 
tolerance is reached, the solver is set up to execute only once per sample (every 0.015 s) to improve the 
execution speed of C-MAPSS. 

Due to the two-way coupling that exists between the spool speeds and the thermodynamic processes, 
the system can be balanced on the basis of the aero-thermodynamic principles. In reality, each component 
has its own gas volume storage, and this compliance creates a lag between components that allows the 
solution to be described by these dynamics directly without a dedicated solver. However, the volume 
dynamics are at a bandwidth far greater than the controller sample rate (by more than an order of 
magnitude; time constants are typically less than 1 ms). This would require the simulation to operate 
much faster than the controller rate, to the detriment of execution speed, and is hence not employed here. 

Since the spool dynamics are slower than the controller dynamics, the closed loop system is operated 
at the controller 67 Hz update rate (0.015 s period) and an iterative solver used to balance the engine at 
this discrete update rate. The solver is based on a Newton-Raphson scheme using a static Jacobian matrix 
J obtained at a single operating point. The errors are driven toward zero through the following difference 
equation 

x k + 1 = x k — J ^ e k 

where ek is an error vector of the same dimension as the vector of independent parameters Xu- The error 
parameters are each taken to establish flow continuity between components (flow exiting a component 
equals the flow entering the next component, minus any bleeds). In the turbines, the independent 
parameters are taken simply as the pressure ratios, while in the fan and compressors these are taken as the 
R-line values. A listing of the five flow continuity errors and the five independent parameters is given in 
table 4. Even using the fixed-Jacobian single-iteration solver, the flow continuity errors remain within 
15 percent at worst (continuity of flow across the HPC) for a typical large-magnitude burst transient. This 
is due in part to the controller limiting the speed of the engine. Although these errors may be undesirable 
for detailed performance studies, for most controls and diagnostics studies, this approach should prove to 
be sufficient. 


TABLE 4.— COMPRESSOR/TURBINE SOLVER PARAMETERS 


[W, represents mass flow at station /.] 



Flow continuity 

Independent 


error quantity 

parameter 

1 

W n -W n ~ W?4 

R-line? an 

2 

W 24 ~W 30 

R-line L pc 

3 

W 4 g - W 40 - RHPTbld.l - THPTbld,2 

R-line hpc 

4 

R 50 - R 48 “ ULPTbld.1 “ Ifi.PTbld.2 

PR H pt 

5 

Wn-W 9 0 

PR L pt 


C. Control System 

The default control system that is provided with C-MAPSS is a gain-scheduled linear control law 
with a simplified limit protection scheme, which is representative of the state-of-the-art in digital engine 
control systems employed by industry. The specifics of engine control systems are proprietary, so details 
of the actual limit schedules, controller time constants, and mode selection thresholds have been 
constructed based on knowledge of the safety, stability, and operability margins of the C-MAPSS engine. 

The comprehensive control system consists of a fan-speed compensator, four limit regulators, and 
core speed acceleration and deceleration limiters. Three high-limit regulators prevent the engine from 
exceeding its design limits for core speed (N 2 ), combustor static pressure (Ps 30 ), and HPT exit 
temperature. The core speed limit is designed to prevent mechanical failure of the rotating components, 


NASA/TM— 2008-215303 





Figure 2. — Illustration of the limit protection philosophy. 


while engine pressure ratio and temperature limits are set up to prevent failure of the high pressure and 
high temperature components. A fourth limit regulator is instituted to prevent the static pressure at the 
exit of the HPC from going too low to prevent lean combustor blowout. The operation of the control 
limits is illustrated in figure 2. 

As shown in figure 2, acceleration and deceleration limits are implemented primarily to prevent 
compressor stall during transients. Secondarily, the acceleration limit is an additional measure to prevent 
over-stress of the rotor and the deceleration protects against blowout. As is common among 
manufacturers (ref. 12), the variable O = Wf /Ps 30 is used to prevent stall; the maximum ® is set to 
prevent HPC stall and the minimum is set to prevent LPC stall. This is because the HPC stall margin 
experiences undershoot as compressor through- flow increases, while the LPC stall margin experiences its 
undershoot as the through-flow decreases. In C-MAPSS, margins are maintained at 15 percent in the 
HPC and 6 percent in the LPC. The minimum and maximum values of ® are determined to maintain 
these margins as /V'f varies. This control limit differs from the four limit regulators in that the fuel flow 
is saturated (by setting the derivative to zero) when acceleration or deceleration exceeds tolerance. To 
calculate the minimum and maximum Wf limits, the minimum and maximum values of ® are scheduled 
against N§ and are multiplied by Psw As will be shown, the fuel flow derivative is accessible for the 
saturation limit since it is the controlled variable. 

The fan speed regulator and limit regulators are designed using the model-matching (MM) method, 
formalized by Edmunds (ref. 13). With this technique, the desired closed-loop transfer function and the 
compensator poles are specified and the compensator’s gain and zeros are obtained to provide the best 
match to the desired transfer function in a least-squares sense. The gain and feedthrough matrices of the 

fan speed regulator are scheduled versus W? and P 2 o- The P 2 o schedule is necessary to consolidate the 
effects of altitude and Mach number variations into one parameter. Each of the limit regulators consists of 
static parameters designed at a representative flight condition consistent with the limit. 

In actual FADEC control systems, extensive provisions are made in the logic structure to avoid 
integrator-windup problems and ensure smooth, chatter-free transition between control modes. The 
C-MAPSS controller emulates these provisions by incorporating an incremental control command and 
interpolating the scheduled linear gains that discretize the entire flight envelope. With the plant 
augmented with a free integrator, the second-order MM regulators are referred to as “incremental” (rate) 
regulators. To prevent integrator windup, only one free integrator is required for all control modes since 
only one is active at any time. Therefore, all control modes operate on the control derivative, instead of 
the absolute (integrated) signal. 


NASA/TM— 2008-215303 


9 




Figure 3. — Fuel flow control logic. Inputs refer to the sensor measurements and the output is the fuel flow command. 


A power management system has been included in order to relate the pilot’s TRA (throttle resolver 
angle) input to a demanded corrected fan speed. In order to approximate a linear TRA-to-net thrust 

relationship, a table lookup is used whose profde is such that the sensitivity of Nf to TRA increases as 
TRA increases. By correcting fan speed with respect to r 20 , it allows the engine to be operated over a 
wide range of thrust levels throughout the full range of flight conditions. Figure 3 depicts the complete 
fuel flow control architecture. 


IV. The C-MAPSS Program User Interface and Operation 

The C-MAPSS program consists of Matlab code, a GUI, and Simulink diagrams which appear to the 
user as shown in figures 4 and 5. Note the user-specified flight condition down the center of the GUI 
(fig. 4) and the user-selected profiles of the three control inputs (TRA, VSV and VBV) and the three 
environmental parameters (altitude, Mach number, and delta ambient temperature) on the right side of the 
GUI. The GUI is structured to facilitate the following basic tasks: generation of flight conditions and 
input profiles; construction of linear models; design of engine controllers and limit regulators via the MM 
method; execution of open-/closed-loop simulations and examination of the results. Thus the user is able 
to perform several practical functions through a point-and-click approach using the menu picks along the 
top of the GUI. Each GUI task is carried out via a Simulink representation of the C-MAPSS engine 
(fig. 5) that is configured appropriately. This section details the various features of the C-MAPSS user 
interface and provides a simple example to demonstrate the operability of the simulation. 


NASA/TM— 2008-215303 


10 



Figure 4. — Front-end GUI of C-MAPSS, for setting up and running the simulation. 


Commercial Modular Aero-Propulsion System Simulation (C-MAPSS) 
(/er. 2.0) 


[timevec.Wf’ datavec .Wf'] 














Output Scopes Initializer 


Figure 5. — Top-level Simulink diagram. 


NASA/TM— 2008-215303 


11 











Figure 6. — Illustration of C-MAPSS subsystem hierarchy. 


A. Implementation and Use 

The engine-level subsystem is shown in figure 6, which is the subsystem that contains the solver, 
shaft dynamics, sensors, actuators, atmospheric model, and engine aero-thermodynamic model. At the 
lowest level of the Simulink hierarchy, the aero-thermodynamic model is comprised of s-functions that 
represent the engine’s major components. The inputs and outputs of the 10 major components and the 
design characteristics for each are given in table 5. In the table, note that the Fan exit flow is split between 
the bypass duct and the LPC inlet. As a result of the split, it should be clear that the pressures, 
temperatures, and flows are related by P 2\ - P 13 - P 22 > T 2\ - f|3 - T 22 > and W 2 1 = w 13 + W 22 ■ 


NASA/TM— 2008-215303 


12 


TABLE 5.— MAJOR COMPONENT MODULES FOR C-MAPSS, 

ALONG WITH THEIR INPUTS AND OUTPUTS 
[Fg, h, FAR and z represent gross thrust, enthalpy, fuel-to-air ratio, and torque, respectively.] 


Component 

s-function 

inputs 

s-function 

outputs 

Inlet 

T\ o, P io> MN 

Go. P 20 

Fan 

T209 ^20? N 1, R-line p an 

flmod.Fan? ^Pmod,Fan? ^-^mod^an 

Gi. P21. IT 2 i, x Fan , SM ¥m 

Bypass Nozzle 

A3, F13, Famb> UvBV 

Wa, FgBvb 

Low Pressure 
Compressor 

T22, P 22 > N\, R-lineipc 

'lmodXPC . <Pmod.LPC> PPmod.LPC 

G4. P24. IT 24, Tlpc, SM l PC 

Variable Bleed 

VBV, T 24 ,P 24 , W 24 , T n ,P u , W l3 

Tvbv 

High Pressure 

T25, P25, IT vnv> M, R-line hpc, VSV 

Go. P 30 . Ps 30 . IT25, W 3 6, XHPC. SM25 

Compressor 

r lmod,HPCi (Pmod.HPC. PRmoi .HPC 

/'LPTbld. IT L p T b|d ,b ITLPTbld,2. ITc u st_bld 
/'HPTbld. ITHPTbld.l. /TnpTbld .2 

Combustor 

Go, Go, W 36 , Wf 

Go. P 40. JT40, FAR^o 

High Pressure 
Turbine 

Go, -P40, FAR40, N2, PRhpt 

I'HPTbld, THPTbld,l> THPTbld ,2 
'lmod.HPT, ( Pmod.HPT 

Gs. P 48 . IT48, FAR^g, Thpt 

Low Pressure 
Turbine 

Gs, -P48, FARn, N], PRlpt 

I'LPTbld, IT] LPTbld, 1 . ITLPTbld,2 
tlmodXPT. (Pmod.LPT 

Go. P50! IT50, FAR S0 , Tlpt 

Core Nozzle 

P50, P 50 . P amb. FAR50 

IT90, Fgc ore 


At this point, it is worth noting how the s-functions are composed. Because there are certain 
advantages and disadvantages of Matlab-based and C-based s-fiinctions, each component has been coded 
in both formats. In short, the Matlab functions are useful for editing the module without needing to 
reprogram and recompile the s-function code, but tend to have long execution times. The C functions, 
while more complicated to implement, allow the full simulation to be executed much more quickly (about 
seven times faster than real time on a standard desktop equipped with a 2.2 GHz processor). 

The C-MAPSS user interface environment is now discussed in greater detail. As has been stated, each 
of the automated functions is accessible from the front-end GUI, which is powered in the background by 
Matlab scripts and the main Simulink file. The various functions are accessed by the menu options at the 
top of the GUI. 

Initialization 

The simulation is initialized by simply balancing the engine to equilibrium for a prescribed set of 
inputs (flight, power setting, and deterioration conditions). The speed of convergence is expedited by 
removing the controller and engine dynamics and replacing these with an augmented, eight-state Newton- 
Raphson solver. The errors in this case include the five continuity errors, the net torques on the two 
shafts, and the controlled variable. In open-loop, the controlled variable is fuel flow, while in closed-loop, 
this may be chosen as either TRA or net thrust in the GUI. As with the standard five-state discrete-time 
solver, the engine balancing solver operates with a static Jacobian matrix to rapidly solve for the 
independent variables. Unlike the standard solver, however, limits are treated by swapping rows of the 
Jacobian matrix corresponding to the limited/un-limited output variable. Implementation-wise, once a 
limit is reached, the output variable to be controlled is switched to this limited variable, and an inverse 
Jacobian corresponding to that variable is selected. The balancing proceeds until the root-mean-square 
(rms) error falls below a certain user-specified threshold. 

Input Profiles 

In normal, undegraded operation, the input profile is specified by the three environmental variables 
(altitude, MN, and delta ambient temperature), the two variable geometry actuator inputs (VSV, VBV), 
and either fuel flow or TRA, depending on whether the intent is to perform open-loop or closed-loop 


NASA/TM— 2008-215303 


13 




simulations. Time-indexed vectors for each of these inputs are specified by either loading an existing 
profile (e.g., takeoff, climb, descent) or constructing a new step or ramp profile in the Input Profile GUI. 
The GUI simply facilitates the task of constructing data vectors that are called by the simulation from the 
Matlab workspace. 

Linearization 

The open-loop engine may be linearized at any arbitrary flight condition for controls and diagnostics 
development. The Linear Engine Model GUI facilitates the process by performing the linearization with 
user-specified perturbation magnitudes on each state and input variable. Once generated, the response of 
the linear model to an input perturbation may then be compared visually to that of the nonlinear model by 
making use of the preconfigured plotting routines within C-MAPSS. 

Control System 

The simulation can be configured to operate open-loop or in one of several closed-loop modes. When 
simulating in closed-loop, the user can choose to employ a linear point fan speed controller, a gain- 
scheduled controller without limit regulators, or a gain-scheduled controller with all limits activated. 
Although a comprehensive set of point controllers has been included with C-MAPSS, users may choose 
to design point compensators of their own. Once a linear model has been generated, the Controller Design 
GUI allows the user to rapidly perform the MM design at that flight condition and conduct loop analysis 
of the compensator design. Of course, the user is free to substitute a customized controller for the 
standard one by simply replacing the contents of the “Controller” Simulink block with a subsystem 
containing the new algorithm. 

Degraded Operation 

Abrupt faults or gradual degradation in the engine can be approximated by use of the health 
parameter inputs. As with the open-/closed-loop command inputs, this is done by specifying an 
appropriate time history for any of the 13 health parameter inputs as time vectors in the Matlab workspace 
or via the Input Profile GUI, where a step or ramp transient may be constructed. The reader is referred to 
other sources for information on possible settings for simulating deterioration (ref. 14) and faults (ref. 15). 

B. Closed-Loop Example 

Some illustrative results of the engine simulation are shown in figures 7 and 8. The test case shown is 
for a burst/chop throttle maneuver between 0° and 100° TRA conducted at sea-level static, standard day 
conditions. The example illustrates that the fan-speed compensator (in control the majority of the time) 
produces a smooth fan speed response that does not violate any limits. The VBV and VSV actuators 
follow schedules that are inversely related to the corrected fan and core speeds, respectively. The only 
limiter that comes into play is the ® ( WfiPs V) ) saturation limit; the maximum is encountered during burst 
and the minimum encountered during chop. Figure 8 shows the transient response of the stall margins in 
the fan and compressor components. Viewed on the pressure ratio map, the fan stall margin evolves 
within a narrow region and hence does not require limit protection. The LPC and HPC, on the other hand, 
both have large-magnitude transient responses that require protection by the ® limit. By virtue of their 
design, the limits prevent the LPC stall margin from falling below 6 percent during chop and the HPC 
stall margin from falling below 1 5 percent during burst. 


NASA/TM— 2008-215303 


14 



VBV pos. (% open) 


100 


50 


60 

40 

20 

0 


10 


20 



2.5 

_ 2 
a 1.5 
g 1 
0.5 




20 


15 


> 10 

co 

> 

5 


0 


10 


20 


10 


20 


0 


10 


20 



9500 
_ 9000 
I 8500 

z 8000 

7500 


0 


_ t _ 

Nc limif 


2000 

S' 

.o__ 

§ 1500 
H 

1000 


rrnt ' j 

T48 limit 


^ 500 
| 400 
o 300 

CO 

« 200 
100 


0 


it 


Ps30 hi lijmit 


10 20 0 10 20 
Time (s) Time (s) 

Figure 7. — Time traces for a burst followed by a chop at sea-level static conditions. 


Ps30 low limit 

10 20 
Time (s) 



c n 
o 
0. 
X 


40 

30 

20 

10 

0 

50 

40 

30 

20 

10 L 

0 


6% margin 

. 

1 

— 


10 


15 


20 


5 10 15 

Time (s) 


20 


15% margin 



25 



100 150 200 250 300 350 

t|_PC 


25 



Figure 8. — Burst/chop trajectories shown in relation to the fan, 
LPC, and HPC pressure ratio versus corrected flow maps. 


NASA/TM— 2008-215303 


15 


Summary 

This paper presents an overview of the construction and implementation of the Commercial Modular 
Aero-Propulsion System Simulation (C-MAPSS) version 2 engine simulation. The basic elements of the 
aero-thermodynamic model have been discussed, as have the details relating to the solver and controller. 
The open-loop engine model has been constructed to provide comprehensive detail for each of the 
components and such that all of the relevant control “handles” and sensors that are of interest to users in 
the engine controls and diagnostics/health management community are provided. The controller has been 
essentially designed to represent modem digital control laws in a simplified, easily understood fashion. 

To that end, the controller consists of a gain-scheduled fan speed controller with associated limit logic to 
prevent the normal over-speed, over-temperature, over-pressure, compressor stall and lean blowout 
conditions. Due to C-MAPSS’ modular structure, a user-developed control law can be easily substituted 
for the existing one. In an effort to simplify common tasks, several simulation functions have been 
automated through the GUI environment. These include initialization of the engine at an arbitrary point, 
creation of linear models and point controllers, and generation of responses to various input profiles. The 
various engine components were implemented as Matlab s-functions to facilitate building and refining 
each of those modules. To promote fast simulations and to provide opportunity for real-time 
implementation, the modules were also deployed as C language-based s-functions. As a result of the steps 
taken to construct the simulation, C-MAPSS is a versatile tool that offers a wide array of functionality. 

References 

1. Parker, K.I. and Guo, T.H., “Development of a Turbofan Engine Simulation in a Graphical 
Simulation Environment,” NASA/TM — 2003-212543, August 2003. 

2. Kim, J.H., Song, T.W., Kim, T.S. and Ro, S.T., “Model Development and Simulation of Transient 
Behavior of Heavy Duty Gas Turbines,” J. Engineering for Gas Turbines and Power, vol. 123, no. 3, 
2001, pp. 589-594. 

3. Alexiou, A. and Mathioudakis, K., “Development of a Turbofan Performance Model Using a Generic 
Simulation Tool,” 2005 ASME Turbo Expo, Reno-Tahoe, NV, June 6-9, 2005. 

4. Camporeale, S.M., Fortunato, B. and Mastrovito, M., “A Modular Code for Real Time Dynamic 
Simulation of Gas Turbines in Simulink,” J. Engineering for Gas Turbines and Power, vol. 128, no. 3, 
2006, pp. 506-517. 

5. Mink G., and Behbahani, A., “The AFRL ICF Generic Gas Turbine Engine Model,” AIAA-2005- 
4538, 41st AIAA/ASME/SAE/ASEE Joint Propulsion Conference and Exhibit, Tucson, AZ, July 10- 
13, 2005. 

6. Frederick, D.K., DeCastro, J.A. and Litt, J.S., “User’s Guide for the Commercial Modular Aero- 
Propulsion System Simulation (C-MAPSS),” NASA/TM-2007-215026, October 2007. 

7. Mattingly, J.D., Elements of Gas Turbine Propulsion, McGraw-Hill, 1996. 

8. Seldner, K., Mihaloew, J.R. and Blaha, R.J., “Generalized Simulation Technique for Turbojet Engine 
System Analysis,” NASA TN D-6610, February 1972. 

9. Kulikov, G.G. and Thompson, H.A. (eds.), Dynamic Modelling of Gas Turbines: Identification, 
Simulation, Condition Monitoring, and Optimal Control, Springer- Verlag, London, 2004. 

10. Spang III, H.A. and Brown, H., “Control of Jet Engines,” Control Engineering Practice, vol. 7, no. 9, 
1999, pp. 1043-1059. 

11. Volponi, A.J., “Gas Turbine Parameter Corrections,” J. Engineering for Gas Turbines and Power, 
vol. 121, no. 4, pp. 613-621. 

12. Martucci, A. and Volponi, A.J., “Fuzzy Fuel Flow Selection Logic for a Real Time Embedded Full 
Authority Digital Engine Control,” J. Engineering for Gas Turbines and Power, vol. 125, no. 4, 2003, 
pp. 909-916. 

13. Maciejowski, J.M., Multivariable Feedback Design, Addison-Wesley, 1989. 


NASA/TM— 2008-215303 


16 



14. Sallee, G.P., “Performance deterioration based on existing (historical) data; JT9D jet engine 
diagnostics program,” NASA CR-1 35448, April 1978. 

15. Ogaji, S.O.T., Sampath, S., Singh, R., and Probert, S.D., “Parameter Selection for Diagnosing a Gas- 
Turbine’s Performance-Deterioration,” Applied Energy, 73, 2002, pp. 25-46. 


NASA/TM— 2008-215303 


17 



REPORT DOCUMENTATION PAGE 

Form Approved 
OMB No. 0704-0188 

The public reporting burden for this collection of information is estimated to average 1 hour per response, including the time for reviewing instructions, searching existing data sources, gathering and maintaining the 
data needed, and completing and reviewing the collection of information. Send comments regarding this burden estimate or any other aspect of this collection of information, including suggestions for reducing this 
burden, to Department of Defense, Washington Headquarters Services, Directorate for Information Operations and Reports (0704-0188), 1215 Jefferson Davis Highway, Suite 1204, Arlington, VA 22202-4302. 
Respondents should be aware that notwithstanding any other provision of law, no person shall be subject to any penalty for failing to comply with a collection of information if it does not display a currently valid OMB 
control number. 

PLEASE DO NOT RETURN YOUR FORM TO THE ABOVE ADDRESS. 

1. REPORT DATE (DD-MM-YYYY) 
01-09-2008 

2. REPORT TYPE 

Technical Memorandum 

3. DATES COVERED (From - To) 

4. TITLE AND SUBTITLE 

A Modular Aero-Propulsion System Simulation of a Large Commercial Aircraft Engine 

5a. CONTRACT NUMBER 

5b. GRANT NUMBER 



5c. PROGRAM ELEMENT NUMBER 

6. AUTHOR(S) 

DeCastro, Jonathan, A.; Litt, Jonathan, S.; Frederick, Dean, K. 

5d. PROJECT NUMBER 

5e. TASK NUMBER 

5f. WORK UNIT NUMBER 

WBS 457280.02.07.03.04.03 

7. PERFORMING ORGANIZATION NAME(S) AND ADDRESS(ES) 

National Aeronautics and Space Administration 
John H. Glenn Research Center at Lewis Field 
Cleveland, Ohio 44135-3191 

8. PERFORMING ORGANIZATION 
REPORT NUMBER 

E-16573 

9. SPONSORING/MONITORING AGENCY NAME(S) AND ADDRESS(ES) 

National Aeronautics and Space Administration 
Washington, DC 20546-0001 

10. SPONSORING/MONITORS 
ACRONYM(S) 

NASA; A1AA 

11. SPONSORING/MONITORING 
REPORT NUMBER 

NASA/TM-2008-2 15303; A1AA-2008- 
4579 

12. DISTRIBUTION/AVAILABILITY STATEMENT 

Unclassified-Unlimited 
Subject Category: 07 

Available electronically at http://gltrs.grc.nasa.gov 

This publication is available from the NASA Center for AeroSpace Information, 301-621-0390 

13. SUPPLEMENTARY NOTES 

14. ABSTRACT 

A simulation of a commercial engine has been developed in a graphical environment to meet the increasing need across the controls and 
health management community for a common research and development platform. This paper describes the Commercial Modular Aero 
Propulsion System Simulation (C-MAPSS), which is representative of a 90,000-pound thrust class two spool, high bypass ratio commercial 
turbofan engine. A control law resembling the state-of-the-art onboard modern aircraft engines is included, consisting of a fan-speed control 
loop supplemented by relevant engine limit protection regulator loops. The objective of this paper is to provide a top-down overview of the 
complete engine simulation package. 

15. SUBJECT TERMS 

Simulation; Aircraft engines; Engine control; Thermodynamic cycles 

16. SECURITY CLASSIFICATION OF: 

17. LIMITATION OF 
ABSTRACT 

uu 

18. NUMBER 
OF 

PAGES 

23 

19a. NAME OF RESPONSIBLE PERSON 

STI Flelp Desk (email:help@sti. nasa.gov) 

a. REPORT b. ABSTRACT c. THIS 

U U PAGE 

u 

19b. TELEPHONE NUMBER (include area code) 

301-621-0390 


Standard Form 298 (Rev. 8-98) 
Prescribed by ANSI Std. Z39-18 




































